=========================
J.U.S.T. CI Functions
=========================

.. default-domain:: bash

.. file:: just_ci_functions.bsh

CI plugin for just

.. envvar:: JUST_CI_CACHE_REPO

Dockerhub repository for CI service cache.

.. seealso::

  :cmd:`ci_load-services`

.. envvar:: JUST_CI_CACHE_VERSION

Version for CI service cache.

.. seealso::

  :cmd:`ci_load-services`

.. envvar:: JUST_CI_CACHE_ARGS

Additional `ci_load.py` arguments for CI service cache as a single string.

.. seealso::

  :cmd:`ci_load-services`

.. envvar:: JUST_CI_RECIPE_REPO

Dockerhub repository for CI recipe cache.

.. seealso::

  :cmd:`ci_load-recipes`, :cmd:`ci_load-recipes-auto`

.. envvar:: JUST_CI_RECIPE_VERSION

Version for CI recipe cache.

.. seealso::

  :cmd:`ci_load-recipes`, :cmd:`ci_load-recipes-auto`

.. envvar:: JUST_CI_RECIPE_ARGS

Additional `ci_load.py` arguments for CI recipe cache as a single string.

.. seealso::

  :cmd:`ci_load-services`

.. command:: ci_load-recipes

:Arguments: [``$1``]... - Recipe names to load

Runs `ci_load.py` for specified docker recipes. Handles loading of both single and multi-stage recipes. Note recipes are not pushed back to the recipe cache (``ci_load.py --no-push ...``).

.. command:: ci_load-recipes-auto

:Arguments: ``$1``... - Dockerfiles to parse

Scans Dockerfiles for ``vsiri/recipe:`` images, and calls :cmd:`ci_load-recipes` on the recipes discovered. Accepts multiple files and ``-`` for stdin

.. command:: ci_load-services

:Arguments: ``$1`` - Docker compose yaml file
            ``$2`` - Main docker-compose service
            [``$3``]... - Optional `ci_load.py` inputs

Runs `ci_load.py` for specified docker services. Recipes are expected to be loaded prior to call via ``just ci load-recipes-auto``.


