<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>J.U.S.T. Makeself Functions &mdash; VSI Common 0.2.2+1dev documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="J.U.S.T. Pip-tools Functions" href="just_pip-tools_functions.auto.html" />
    <link rel="prev" title="J.U.S.T. Install CI Functions" href="just_install_functions.auto.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            VSI Common
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">J.U.S.T. Useful Simple Tasking</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../installation.html">J.U.S.T. Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart_user.html">J.U.S.T. Quickstart Guide for Users</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html">Getting started developing with <code class="docutils literal notranslate"><span class="pre">just</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../just.auto.html">J.U.S.T.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../files.html">J.U.S.T. Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../just-tab.auto.html">Tab completion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../just_common.auto.html">Just Common Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../just_env.auto.html">Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../just_functions.auto.html">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../just_version.auto.html">Just Version</a></li>
<li class="toctree-l2"><a class="reference internal" href="../just_wrap.auto.html">J.U.S.T. Wrap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../new_just.auto.html">New J.U.S.T.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../just_diff.auto.html">Updating a just environment</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">J.U.S.T. Plugins</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="docker/index.html">J.U.S.T. Docker Plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="singularity/index.html">J.U.S.T. Singularity Plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="container_functions.auto.html">Container Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="just_bashcov_functions.auto.html">J.U.S.T. Bash Coverage Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="just_ci_functions.auto.html">J.U.S.T. CI Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="just_default_run_functions.auto.html">J.U.S.T. Default Run Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="just_git_airgap_repo.auto.html">J.U.S.T. Mirror to an Air-gapped Repository</a></li>
<li class="toctree-l3"><a class="reference internal" href="just_git_functions.auto.html">J.U.S.T. Git Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="just_install_functions.auto.html">J.U.S.T. Install CI Functions</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">J.U.S.T. Makeself Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="just_pip-tools_functions.auto.html">J.U.S.T. Pip-tools Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="just_pre-commit_functions.auto.html">J.U.S.T. Pre-commit Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="just_robodoc_functions.auto.html">J.U.S.T. Robodoc Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="just_sphinx_functions.auto.html">J.U.S.T. Sphinx Docs Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="just_test_functions.auto.html">J.U.S.T. Test Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="just_troubleshooter_functions.auto.html">J.U.S.T. Troubleshooter Functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../linux/index.html">Linux Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../windows/index.html">Windows Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tests/index.html">Unit Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python/modules.html">vsi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docker/recipes/get-pipenv.auto.html">Get Pipenv</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docker/recipes/pip-8210.auto.html">pip 8210</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docker/recipes/index.html">Docker recipes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../style.html">Contributing Style Guide</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">VSI Common</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">J.U.S.T. Useful Simple Tasking</a></li>
          <li class="breadcrumb-item"><a href="index.html">J.U.S.T. Plugins</a></li>
      <li class="breadcrumb-item active">J.U.S.T. Makeself Functions</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/just/plugins/just_makeself_functions.auto.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="j-u-s-t-makeself-functions">
<h1>J.U.S.T. Makeself Functions<a class="headerlink" href="#j-u-s-t-makeself-functions" title="Permalink to this heading"></a></h1>
<p>A plugin for creating a <a class="reference external" href="https://makeself.io/">makeself executable</a>, using a docker container.</p>
<p>The features of this plugin are focused on putting <a class="reference internal" href="../just.auto.html#file-just"><code class="xref bash bash-file docutils literal notranslate"><span class="pre">just</span></code></a> in a self sufficient executable, for deployment of just and just projects.</p>
<ul class="simple">
<li><p>A just deploying, referred to as <code class="docutils literal notranslate"><span class="pre">juste</span></code> (<code class="docutils literal notranslate"><span class="pre">just</span></code> Executable) allows just to be run without the vsi_common submodule in a project. However, it does require you have <code class="docutils literal notranslate"><span class="pre">juste</span></code> installed/available on every machine you need it on. No other dependencies are needed, other than <code class="docutils literal notranslate"><span class="pre">bash</span></code> and common linux core tools like <code class="docutils literal notranslate"><span class="pre">tar</span></code>, <code class="docutils literal notranslate"><span class="pre">awk</span></code> and <code class="docutils literal notranslate"><span class="pre">sed</span></code>.</p></li>
<li><p>A “just project executable” is similar to <code class="docutils literal notranslate"><span class="pre">juste</span></code>, but with one significant difference. It includes all the files of a project with it. This means that the repository for a project is no longer needed to run the project. This makes for a very easy to run deployment strategy. Again, the only dependencies are <code class="docutils literal notranslate"><span class="pre">bash</span></code>, <code class="docutils literal notranslate"><span class="pre">tar</span></code>, <code class="docutils literal notranslate"><span class="pre">awk</span></code>, <code class="docutils literal notranslate"><span class="pre">sed</span></code>, etc…</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Large files should not includes in just project executables. Makeself (quietly) extract the entire contents of the project every time it is run. While this works with in reason, once you start including MBs of files, this time will eventually become noticeable.</p>
</div>
<p>The executables made by this plugin put the makeself executables in <code class="docutils literal notranslate"><span class="pre">quiet</span></code> modes, and the normal argument parsing of makeself is also disabled. This creates a smoother experience for the end user.</p>
<p>Makeself argument parsing can be enabled by exporting <code class="docutils literal notranslate"><span class="pre">MAKESELF_PARSE=true</span></code>. This can be useful if you ever want to permanently extract the executable, and use the expanded version.</p>
<dl class="bash file">
<dt class="sig sig-object bash" id="file-just_makeself_functions.bsh">
<span class="sig-name descname"><span class="pre">just_makeself_functions.bsh</span></span><a class="headerlink" href="#file-just_makeself_functions.bsh" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<p>Most environment variables try to auto determine reasonable defaults, but they can always be overridden and customized.</p>
<dl class="bash env">
<dt class="sig sig-object bash" id="env-just_makeself_functions.bsh MAKESELF_NAME">
<span class="sig-name descname"><span class="pre">MAKESELF_NAME</span></span><a class="headerlink" href="#env-just_makeself_functions.bsh MAKESELF_NAME" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<p>The name of the makeself executable written to <a class="reference internal" href="#env-just_makeself_functions.bsh MAKESELF_DIST_DIR"><code class="xref bash bash-env docutils literal notranslate"><span class="pre">MAKESELF_DIST_DIR</span></code></a>. Default: <code class="docutils literal notranslate"><span class="pre">just</span></code></p>
<dl class="bash env">
<dt class="sig sig-object bash" id="env-just_makeself_functions.bsh MAKESELF_LABEL">
<span class="sig-name descname"><span class="pre">MAKESELF_LABEL</span></span><a class="headerlink" href="#env-just_makeself_functions.bsh MAKESELF_LABEL" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<p>The makeself internal “label”. Not really relevant, as quiet mode is enforced. Default: just_label.</p>
<dl class="bash env">
<dt class="sig sig-object bash" id="env-just_makeself_functions.bsh MAKESELF_SOURCE_DIR">
<span class="sig-name descname"><span class="pre">MAKESELF_SOURCE_DIR</span></span><a class="headerlink" href="#env-just_makeself_functions.bsh MAKESELF_SOURCE_DIR" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<p>The input directory of the files used to add files to the makeself executable. Default: <code class="docutils literal notranslate"><span class="pre">${JUST_PROJECT_PREFIX}_MAKESELF_SRC_DIR</span></code> or else <code class="docutils literal notranslate"><span class="pre">${JUST_PROJECT_PREFIX}_CWD</span></code>.</p>
<dl class="bash env">
<dt class="sig sig-object bash" id="env-just_makeself_functions.bsh MAKESELF_DIST_DIR">
<span class="sig-name descname"><span class="pre">MAKESELF_DIST_DIR</span></span><a class="headerlink" href="#env-just_makeself_functions.bsh MAKESELF_DIST_DIR" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<p>The output directory for the makeself distribution. Default: <code class="docutils literal notranslate"><span class="pre">${JUST_PROJECT_PREFIX}_MAKESELF_DIST_DIR</span></code> or else <code class="docutils literal notranslate"><span class="pre">${MAKESELF_SOURCE_DIR}/dist</span></code></p>
<dl class="bash env">
<dt class="sig sig-object bash" id="env-just_makeself_functions.bsh UID_CONTAINER">
<span class="sig-name descname"><span class="pre">UID_CONTAINER</span></span><a class="headerlink" href="#env-just_makeself_functions.bsh UID_CONTAINER" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="bash env">
<dt class="sig sig-object bash" id="env-just_makeself_functions.bsh GIDS_CONTAINER">
<span class="sig-name descname"><span class="pre">GIDS_CONTAINER</span></span><a class="headerlink" href="#env-just_makeself_functions.bsh GIDS_CONTAINER" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<p>Used to determine user id in container. Should be automatically set by Project’s <code class="docutils literal notranslate"><span class="pre">${JUST_PROJECT_PREFIX}_UID</span></code> and <code class="docutils literal notranslate"><span class="pre">${JUST_PROJECT_PREFIX}_GID</span></code>, or else uses <code class="docutils literal notranslate"><span class="pre">1000</span></code>.</p>
<dl class="bash env">
<dt class="sig sig-object bash" id="env-just_makeself_functions.bsh VSI_COMMON_JUST_SETTINGS">
<span class="sig-name descname"><span class="pre">VSI_COMMON_JUST_SETTINGS</span></span><a class="headerlink" href="#env-just_makeself_functions.bsh VSI_COMMON_JUST_SETTINGS" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<p>In more complicated projects, the <span class="target" id="index-0"></span><a class="reference internal" href="../just_functions.auto.html#envvar-JUST_SETTINGS"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">JUST_SETTINGS</span></code></a> variable cannot be auto determined, and must be set via <a class="reference internal" href="#env-just_makeself_functions.bsh VSI_COMMON_JUST_SETTINGS"><code class="xref bash bash-env docutils literal notranslate"><span class="pre">VSI_COMMON_JUST_SETTINGS</span></code></a>.</p>
<p>Set values should start with <code class="docutils literal notranslate"><span class="pre">${JUST_PATH_ESC}/</span></code> and must be in the container’s file system, not hosts. That means it depends on how <a class="reference internal" href="#env-just_makeself_functions.bsh MAKESELF_SOURCE_DIR"><code class="xref bash bash-env docutils literal notranslate"><span class="pre">MAKESELF_SOURCE_DIR</span></code></a> is mounted.</p>
<dl class="bash function">
<dt class="sig sig-object bash" id="function-just_makeself_functions.bsh makeself_defaultify">
<span class="sig-name descname"><span class="pre">makeself_defaultify</span></span><a class="headerlink" href="#function-just_makeself_functions.bsh makeself_defaultify" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="bash command">
<dt class="sig sig-object bash" id="command-just_makeself_functions.bsh makeself_defaultify makeself_build">
<span class="sig-prename descclassname"><span class="pre">just</span> <span class="pre">makeself</span> <span class="pre">build</span></span><a class="headerlink" href="#command-just_makeself_functions.bsh makeself_defaultify makeself_build" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<p>Build the makeself docker images.</p>
<dl class="bash env">
<dt class="sig sig-object bash" id="env-just_makeself_functions.bsh makeself_defaultify MAKESELF_IMAGE">
<span class="sig-name descname"><span class="pre">MAKESELF_IMAGE</span></span><a class="headerlink" href="#env-just_makeself_functions.bsh makeself_defaultify MAKESELF_IMAGE" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<p>The name of the makeself docker image. Default: vsiri/makeself:latest</p>
<dl class="bash env">
<dt class="sig sig-object bash" id="env-just_makeself_functions.bsh makeself_defaultify MAKESELF_VERSION">
<span class="sig-name descname"><span class="pre">MAKESELF_VERSION</span></span><a class="headerlink" href="#env-just_makeself_functions.bsh makeself_defaultify MAKESELF_VERSION" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<p>The branch/tag name or SHA of makeself used. Requires version 2.4.3 or newer.</p>
<dl class="bash command">
<dt class="sig sig-object bash" id="command-just_makeself_functions.bsh makeself_defaultify makeself_just-project">
<span class="sig-prename descclassname"><span class="pre">just</span> <span class="pre">makeself</span> <span class="pre">just-project</span></span><a class="headerlink" href="#command-just_makeself_functions.bsh makeself_defaultify makeself_just-project" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">[--tests]</span></code> - Include unit tests. Calling this from another project is tricky though. For example, <code class="docutils literal notranslate"><span class="pre">./just</span> <span class="pre">--wrap</span> <span class="pre">bash</span> <span class="pre">-c</span> <span class="pre">'JUSTFILE=&quot;${VSI_COMMON_DIR}/Justfile&quot;</span> <span class="pre">just</span> <span class="pre">test'</span></code></p></li>
</ul>
</dd>
</dl>
<p>Creates a just project executable using makeself. Relative paths will be with respect to <code class="docutils literal notranslate"><span class="pre">${JUST_PROJECT_PREFIX}_MAKESELF_SRC_DIR</span></code>. After the initial executable is added, calls to <strong class="command">makeself_add-git-files</strong> and <strong class="command">makeself_add-files</strong> should be made to add project files.</p>
<p>This target should be used in conjunction with <a class="reference internal" href="#command-just_makeself_functions.bsh makeself_defaultify makeself_add-git-files"><code class="xref bash bash-cmd docutils literal notranslate"><span class="pre">makeself_add-git-files</span></code></a> which automatically uses <code class="docutils literal notranslate"><span class="pre">.git</span></code> metadata to simplify the extra tar arguments needed, or <a class="reference internal" href="#command-just_makeself_functions.bsh makeself_defaultify makeself_add-files"><code class="xref bash bash-cmd docutils literal notranslate"><span class="pre">makeself_add-files</span></code></a> for maximum flexibility.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#command-just_makeself_functions.bsh makeself_defaultify makeself_add-git-files"><code class="xref bash bash-cmd docutils literal notranslate"><span class="pre">makeself_add-git-files</span></code></a>, <a class="reference internal" href="#command-just_makeself_functions.bsh makeself_defaultify makeself_add-files"><code class="xref bash bash-cmd docutils literal notranslate"><span class="pre">makeself_add-files</span></code></a></p>
</div>
<dl class="bash command">
<dt class="sig sig-object bash" id="command-just_makeself_functions.bsh makeself_defaultify makeself_add-files">
<span class="sig-prename descclassname"><span class="pre">just</span> <span class="pre">makeself</span> <span class="pre">add-files</span></span><a class="headerlink" href="#command-just_makeself_functions.bsh makeself_defaultify makeself_add-files" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">$1</span></code> - Directory to add</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[$2]</span></code> - Extra tar flags to be passed to makeself/tar</p></li>
</ul>
</dd>
</dl>
<p>After the initial just executable is created by calling <strong class="command">makeself_just-project</strong>, project directories are added using <strong class="command">makeself_add-files</strong></p>
<p>The second argument can be used to exclude files, and in complicated situations, set up path transforms.
* Simple case: <code class="docutils literal notranslate"><span class="pre">${project_dir}/external/vsi_common</span></code>
* Complicated case: <code class="docutils literal notranslate"><span class="pre">${project_dir}/external/${other_project}/external/vsi_common</span></code></p>
<p class="rubric">Example just targets</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># ``MY_PROJECT_MAKESELF_SRC_DIR`` should be set to ``${MY_PROJECT_CWD}`` in ``my_project.env``</span>

makeself<span class="o">)</span><span class="w"> </span><span class="c1"># Simple case</span>
<span class="w">  </span>justify<span class="w"> </span>makeself<span class="w"> </span>just-project
<span class="w">  </span>justify<span class="w"> </span>makeself<span class="w"> </span>add-files<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">MY_PROJECT_CWD</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;--exclude .git --exclude ./external/vsi_common&quot;</span>
<span class="w">  </span><span class="p">;;</span>

makeself_complicated<span class="o">)</span><span class="w"> </span><span class="c1"># Complicated case</span>
<span class="w">  </span><span class="c1"># First step is the same; it uses your ${JUST_PROJECT_PREFIX}_MAKESELF_SRC_DIR to determine the &quot;main dir&quot;,</span>
<span class="w">  </span><span class="c1"># so it can determine the relative path of VSI_COMMON_DIR</span>
<span class="w">  </span>justify<span class="w"> </span>makeself<span class="w"> </span>just-project

<span class="w">  </span><span class="c1"># The &quot;other project&quot; has a different default settings file.</span>
<span class="w">  </span><span class="c1"># Tell the makeself plugin what it is</span>
<span class="w">  </span><span class="nb">local</span><span class="w"> </span><span class="nv">VSI_COMMON_JUST_SETTINGS</span><span class="o">=</span>/src/other_project.env
<span class="w">  </span><span class="c1"># Now determine the other project&#39;s relative path (again, wrt ${JUST_PROJECT_PREFIX}_MAKESELF_SRC_DIR, which is the same as &quot;.&quot;)</span>
<span class="w">  </span><span class="nb">local</span><span class="w"> </span><span class="nv">other_project_rel</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>relative_path<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">OTHER_PROJECT_CWD</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>.<span class="k">)</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="c1"># Add the other project files</span>
<span class="w">  </span>justify<span class="w"> </span>makeself<span class="w"> </span>add-files<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">OTHER_PROJECT_CWD</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="s2">&quot;--show-transformed --transform s|^\./|./</span><span class="si">${</span><span class="nv">other_project_rel</span><span class="si">}</span><span class="s2">/| --exclude=.git --exclude=./external/vsi_common&quot;</span>
<span class="w">    </span><span class="c1"># The above transform, makes the files in /src/ appear to be in the</span>
<span class="w">    </span><span class="c1"># &quot;relative&quot; path, determined above</span>

<span class="w">  </span><span class="c1"># Finally add the &quot;main&quot; project files.</span>
<span class="w">  </span>justify<span class="w"> </span>makeself<span class="w"> </span>add-files<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">MY_PROJECT_CWD</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;--exclude .git --exclude ./external/other_project&quot;</span>

<span class="w">  </span><span class="c1"># A neat trick to &quot;exclude all subdirectories except those you want to include&quot;</span>
<span class="w">  </span><span class="c1"># justify makeself add-files &quot;${MY_PROJECT_CWD}&quot; \</span>
<span class="w">  </span><span class="c1">#   &quot;$(find . -mindepth 1 -maxdepth 1 -type d -not -name keep_dir_1 \</span>
<span class="w">  </span><span class="c1">#                                             -not -name keep_dir_2 \</span>
<span class="w">  </span><span class="c1">#                                             -not -name keep_dir_3 -printf &#39; --exclude %p&#39;)&quot;</span>
<span class="w">  </span><span class="c1"># Note: This also includes all the files in the root dir too. This can</span>
<span class="w">  </span><span class="c1"># be customized you your heart&#39;s content.</span>
<span class="w">  </span><span class="p">;;</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#command-just_makeself_functions.bsh makeself_defaultify makeself_just-project"><code class="xref bash bash-cmd docutils literal notranslate"><span class="pre">makeself_just-project</span></code></a> <a class="reference internal" href="#command-just_makeself_functions.bsh makeself_defaultify makeself_add-git-files"><code class="xref bash bash-cmd docutils literal notranslate"><span class="pre">makeself_add-git-files</span></code></a></p>
</div>
<dl class="bash command">
<dt class="sig sig-object bash" id="command-just_makeself_functions.bsh makeself_defaultify makeself_add-git-files">
<span class="sig-prename descclassname"><span class="pre">just</span> <span class="pre">makeself</span> <span class="pre">add-git-files</span></span><a class="headerlink" href="#command-just_makeself_functions.bsh makeself_defaultify makeself_add-git-files" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">$1</span></code> - Directory to add (can be relative or absolute)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[$2]</span></code> - Extra tar flags to be passed to makeself/tar</p></li>
</ul>
</dd>
</dl>
<p>After the initial just executable is created by calling <strong class="command">makeself_just-project</strong>, git project directories are added using <strong class="command">makeself_add-git-files</strong></p>
<p><a class="reference internal" href="#command-just_makeself_functions.bsh makeself_defaultify makeself_add-git-files"><code class="xref bash bash-cmd docutils literal notranslate"><span class="pre">makeself_add-git-files</span></code></a> has many advantages over <a class="reference internal" href="#command-just_makeself_functions.bsh makeself_defaultify makeself_add-files"><code class="xref bash bash-cmd docutils literal notranslate"><span class="pre">makeself_add-files</span></code></a></p>
<ol class="arabic simple">
<li><p>No need for you to exclude <code class="docutils literal notranslate"><span class="pre">.git</span></code>. This is appended to <code class="docutils literal notranslate"><span class="pre">TAR_EXTRA</span></code> for you</p></li>
<li><p>No need to setup the path transform, this is auto determined for you</p></li>
<li><p>Only git tracked files are added. Ignored and untracked files are not added. This both simplifies the exclude pattern and prevents accidentally including of large files.</p></li>
</ol>
<p>The second argument can still be used to exclude files or pass any other arguments to <code class="docutils literal notranslate"><span class="pre">tar</span></code>.
* Simple case: <code class="docutils literal notranslate"><span class="pre">${project_dir}/external/vsi_common</span></code>
* Complicated case: <code class="docutils literal notranslate"><span class="pre">${project_dir}/external/${other_project}/external/vsi_common</span></code></p>
<p class="rubric">Example just targets</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># ``MY_PROJECT_MAKESELF_SRC_DIR`` should be set to ``${MY_PROJECT_CWD}`` in ``my_project.env``</span>

makeself<span class="o">)</span><span class="w"> </span><span class="c1"># Simple case</span>
<span class="w">  </span>justify<span class="w"> </span>makeself<span class="w"> </span>just-project
<span class="w">  </span>justify<span class="w"> </span>makeself<span class="w"> </span>add-git-files<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">MY_PROJECT_CWD</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;--exclude ./external&quot;</span>
<span class="w">  </span><span class="p">;;</span>

makeself_complicated<span class="o">)</span><span class="w"> </span><span class="c1"># Complicated case</span>
<span class="w">  </span><span class="c1"># First step is the same</span>
<span class="w">  </span>justify<span class="w"> </span>makeself<span class="w"> </span>just-project

<span class="w">  </span><span class="c1"># Add the other project files</span>
<span class="w">  </span>justify<span class="w"> </span>makeself<span class="w"> </span>add-git-files<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">OTHER_PROJECT_CWD</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="s2">&quot;--exclude=./external/vsi_common&quot;</span>

<span class="w">  </span><span class="c1"># Finally add the &quot;main&quot; project files.</span>
<span class="w">  </span>justify<span class="w"> </span>makeself<span class="w"> </span>add-git-files<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">MY_PROJECT_CWD</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="s2">&quot;--exclude ./external/other_project&quot;</span>
<span class="w">  </span><span class="p">;;</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#command-just_makeself_functions.bsh makeself_defaultify makeself_just-project"><code class="xref bash bash-cmd docutils literal notranslate"><span class="pre">makeself_just-project</span></code></a> <a class="reference internal" href="#command-just_makeself_functions.bsh makeself_defaultify makeself_add-files"><code class="xref bash bash-cmd docutils literal notranslate"><span class="pre">makeself_add-files</span></code></a></p>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="just_install_functions.auto.html" class="btn btn-neutral float-left" title="J.U.S.T. Install CI Functions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="just_pip-tools_functions.auto.html" class="btn btn-neutral float-right" title="J.U.S.T. Pip-tools Functions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Vision Systems, Inc.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>