<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>J.U.S.T. Files &mdash; VSI Common 0.2.2+1dev documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Tab completion" href="just-tab.auto.html" />
    <link rel="prev" title="J.U.S.T." href="just.auto.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            VSI Common
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">J.U.S.T. Useful Simple Tasking</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="installation.html">J.U.S.T. Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart_user.html">J.U.S.T. Quickstart Guide for Users</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html">Getting started developing with <code class="docutils literal notranslate"><span class="pre">just</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="just.auto.html">J.U.S.T.</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">J.U.S.T. Files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#justfile">Justfile</a></li>
<li class="toctree-l3"><a class="reference internal" href="#project-environment-files">Project Environment Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#advanced-setups">Advanced setups</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#chaining-a-multiple-justfiles">Chaining a multiple Justfiles</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="just-tab.auto.html">Tab completion</a></li>
<li class="toctree-l2"><a class="reference internal" href="just_common.auto.html">Just Common Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="just_env.auto.html">Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="just_functions.auto.html">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="just_version.auto.html">Just Version</a></li>
<li class="toctree-l2"><a class="reference internal" href="just_wrap.auto.html">J.U.S.T. Wrap</a></li>
<li class="toctree-l2"><a class="reference internal" href="new_just.auto.html">New J.U.S.T.</a></li>
<li class="toctree-l2"><a class="reference internal" href="just_diff.auto.html">Updating a just environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugins/index.html">J.U.S.T. Plugins</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../linux/index.html">Linux Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../windows/index.html">Windows Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tests/index.html">Unit Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/modules.html">vsi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docker/recipes/get-pipenv.auto.html">Get Pipenv</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docker/recipes/index.html">Docker recipes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../style.html">Contributing Style Guide</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">VSI Common</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">J.U.S.T. Useful Simple Tasking</a></li>
      <li class="breadcrumb-item active">J.U.S.T. Files</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/just/files.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="j-u-s-t-files">
<h1>J.U.S.T. Files<a class="headerlink" href="#j-u-s-t-files" title="Permalink to this heading"></a></h1>
<section id="justfile">
<span id="just-justfile-file"></span><h2>Justfile<a class="headerlink" href="#justfile" title="Permalink to this heading"></a></h2>
<dl class="bash file">
<dt class="sig sig-object bash" id="file-Justfile">
<span class="sig-name descname"><span class="pre">Justfile</span></span><a class="headerlink" href="#file-Justfile" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<p>Your <a class="reference internal" href="#file-Justfile"><code class="xref bash bash-file docutils literal notranslate"><span class="pre">Justfile</span></code></a> is the main file sourced by just that defines a just project. The primary purpose of the Justfile is to define the function <a class="reference internal" href="#function-Justfile caseify"><code class="xref bash bash-func docutils literal notranslate"><span class="pre">caseify</span></code></a>.</p>
<dl class="bash function">
<dt class="sig sig-object bash" id="function-Justfile caseify">
<span class="sig-name descname"><span class="pre">caseify</span></span><a class="headerlink" href="#function-Justfile caseify" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<p><a class="reference internal" href="#function-Justfile caseify"><code class="xref bash bash-func docutils literal notranslate"><span class="pre">caseify</span></code></a> is a user defined function that parses and handle one call (<a class="reference internal" href="just.auto.html#just"><span class="std std-ref">J.U.S.T.</span></a> will handle multiple calls by calling caseify multiple times for you, so you must not use a while loop and try to parse multiple calls). This should be done using a <code class="docutils literal notranslate"><span class="pre">case</span></code> statement, or else the <a class="reference internal" href="just.auto.html#command-just help"><code class="xref bash bash-cmd docutils literal notranslate"><span class="pre">just</span> <span class="pre">help</span></code></a> parsing will not identify targets correctly. If you choose not to use a <code class="docutils literal notranslate"><span class="pre">case</span></code> statement, comments in the form of <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">target)</span> <span class="pre">#</span> <span class="pre">Help</span> <span class="pre">text</span> <span class="pre">here</span></code> can still be utilized to satisfy <a class="reference internal" href="just.auto.html#command-just help"><code class="xref bash bash-cmd docutils literal notranslate"><span class="pre">just</span> <span class="pre">help</span></code></a>’s parsing.</p>
<p><a class="reference internal" href="#function-Justfile caseify"><code class="xref bash bash-func docutils literal notranslate"><span class="pre">caseify</span></code></a> should try to match the first argument (<code class="docutils literal notranslate"><span class="pre">$1</span></code>) and keep count of the number of additional arguments used and stored the tally in <code class="docutils literal notranslate"><span class="pre">extra_args</span></code>.</p>
<p class="rubric">Example</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">Justfile</span><a class="headerlink" href="#id1" title="Permalink to this code"></a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="c1">#!/usr/bin/env bash</span>

<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">BASH_SOURCE</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>!<span class="o">=</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">0</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="c1"># If being sourced</span>
<span class="w">   </span><span class="nb">set</span><span class="w"> </span>-euE
<span class="w"> </span><span class="k">fi</span>
<span class="w"> </span><span class="nb">source</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">VSI_COMMON_DIR</span><span class="si">}</span><span class="s2">/linux/just_env&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>dirname<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">BASH_SOURCE</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&quot;</span><span class="k">)</span><span class="s2">/cyclops.env&quot;</span>

<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">PROJECT_CWD</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="w"> </span><span class="k">function</span><span class="w"> </span>caseify<span class="o">()</span>
<span class="w"> </span><span class="o">{</span>
<span class="w">   </span><span class="nb">local</span><span class="w"> </span><span class="nv">just_arg</span><span class="o">=</span><span class="nv">$1</span>
<span class="w">   </span><span class="nb">shift</span><span class="w"> </span><span class="m">1</span>
<span class="w">   </span><span class="k">case</span><span class="w"> </span><span class="si">${</span><span class="nv">just_arg</span><span class="si">}</span><span class="w"> </span><span class="k">in</span>
<span class="w">     </span>foo<span class="o">)</span><span class="w"> </span><span class="c1">#ls foo files</span>
<span class="w">       </span>ls
<span class="w">       </span><span class="p">;;</span>
<span class="w">     </span>two<span class="o">)</span><span class="w"> </span><span class="c1"># Target with two arguments</span>
<span class="w">       </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$1</span><span class="w"> </span><span class="nv">$2</span>
<span class="w">       </span><span class="nv">extra_args</span><span class="o">=</span><span class="m">2</span>
<span class="w">       </span><span class="p">;;</span>
<span class="w">     </span><span class="c1"># When a target starts with an _, it is hidden and is not included in</span>
<span class="w">     </span><span class="c1"># tab complete. It remains hidden from help unless a help comment is</span>
<span class="w">     </span><span class="c1"># added</span>
<span class="w">     </span>_hidden<span class="o">)</span>
<span class="w">       </span><span class="nb">echo</span><span class="w"> </span>Shhhhh
<span class="w">       </span><span class="p">;;</span>
<span class="w">     </span>*<span class="o">)</span>
<span class="w">       </span>defaultify<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">just_arg</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="si">${</span><span class="p">@+</span><span class="s2">&quot;</span><span class="si">${</span><span class="p">@</span><span class="si">}</span><span class="s2">&quot;</span><span class="si">}</span>
<span class="w">       </span><span class="p">;;</span>
<span class="w">   </span><span class="k">esac</span>
<span class="w"> </span><span class="o">}</span>

<span class="w"> </span><span class="k">if</span><span class="w"> </span>!<span class="w"> </span><span class="nb">command</span><span class="w"> </span>-v<span class="w"> </span>justify<span class="w"> </span><span class="p">&amp;</span>&gt;<span class="w"> </span>/dev/null<span class="p">;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span>caseify<span class="w"> </span><span class="si">${</span><span class="p">@+</span><span class="s2">&quot;</span><span class="si">${</span><span class="p">@</span><span class="si">}</span><span class="s2">&quot;</span><span class="si">}</span><span class="p">;</span><span class="k">fi</span>
</pre></div>
</div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="just_functions.auto.html#function-just_functions.bsh source_environment_files"><code class="xref bash bash-func docutils literal notranslate"><span class="pre">just_functions.bsh</span> <span class="pre">source_environment_files</span></code></a></dt><dd><p>Sources environment</p>
</dd>
<dt><a class="reference internal" href="just_functions.auto.html#function-just_functions.bsh get_args"><code class="xref bash bash-func docutils literal notranslate"><span class="pre">just_functions.bsh</span> <span class="pre">get_args</span></code></a></dt><dd><p>Parses a block of arguments</p>
</dd>
<dt><a class="reference internal" href="just_functions.auto.html#function-just_functions.bsh get_additional_args"><code class="xref bash bash-func docutils literal notranslate"><span class="pre">just_functions.bsh</span> <span class="pre">get_additional_args</span></code></a></dt><dd><p>Parses another block of arguments</p>
</dd>
<dt><a class="reference internal" href="just.auto.html#command-just help"><code class="xref bash bash-cmd docutils literal notranslate"><span class="pre">just</span> <span class="pre">help</span></code></a></dt><dd><p>Help test</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">just</span> <span class="pre">JUSTFILE</span></code></dt><dd><p>Sets <a class="reference internal" href="#file-Justfile"><code class="xref bash bash-file docutils literal notranslate"><span class="pre">Justfile</span></code></a> filename to load</p>
</dd>
</dl>
</div>
<span class="target" id="just-setup-file"></span><dl class="bash file">
<dt class="sig sig-object bash" id="file-setup.env">
<span class="sig-name descname"><span class="pre">setup.env</span></span><a class="headerlink" href="#file-setup.env" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<p>The <a class="reference internal" href="#file-setup.env"><code class="xref bash bash-file docutils literal notranslate"><span class="pre">setup.env</span></code></a> is a necessary evil that must be sourced every time you start a terminal session. It mainly contains the relative location of the <code class="docutils literal notranslate"><span class="pre">vsi_common</span></code> repo and adds just to the path using that. It should look like:</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">setup.env</span><a class="headerlink" href="#id2" title="Permalink to this code"></a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">JUST_SETUP_SCRIPT</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>basename<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">BASH_SOURCE</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&quot;</span><span class="k">)</span><span class="s2">&quot;</span>
<span class="nb">source</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>dirname<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">BASH_SOURCE</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&quot;</span><span class="k">)</span><span class="s2">/external/vsi_common/env.bsh&quot;</span>
<span class="nb">unset</span><span class="w"> </span>JUSTFILE
</pre></div>
</div>
</div>
<ul class="simple">
<li><p>The first line is a place holder for a feature that has yet to be created</p></li>
<li><p>The third line fixes a bug when you are switching between projects and don’t want to accidentally use the wrong Justfile. If you are using a custom Justfile, this would be the place to set it.</p></li>
<li><p>The second line is the important line that sets up vsi_common on the path so that typing <code class="docutils literal notranslate"><span class="pre">just</span></code> works</p></li>
</ul>
</section>
<section id="project-environment-files">
<span id="just-project-env-files"></span><h2>Project Environment Files<a class="headerlink" href="#project-environment-files" title="Permalink to this heading"></a></h2>
<p>A good <a class="reference internal" href="#file-Justfile"><code class="xref bash bash-file docutils literal notranslate"><span class="pre">Justfile</span></code></a> and just project should have no hard coded paths or values in it, but should work out of the box with their defaults. But if that’s the case, the defaults need to come from somewhere, and a way to override those values locally need to go somewhere. These values come from the project environment files.</p>
<dl class="bash file">
<dt class="sig sig-object bash" id="file-project.env">
<span class="sig-name descname"><span class="pre">project.env</span></span><a class="headerlink" href="#file-project.env" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<p>Your default settings go in your project settings env file. Unlike the <a class="reference internal" href="#file-Justfile"><code class="xref bash bash-file docutils literal notranslate"><span class="pre">Justfile</span></code></a>, you are encouraged to customize the name of this file. The name of your settings file is passed to <code class="docutils literal notranslate"><span class="pre">just_env</span></code> in your <a class="reference internal" href="#file-Justfile"><code class="xref bash bash-file docutils literal notranslate"><span class="pre">Justfile</span></code></a> and is automatically stored in <span class="target" id="index-0"></span><a class="reference internal" href="just_functions.auto.html#envvar-JUST_SETTINGS"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">JUST_SETTINGS</span></code></a>. In the example above, you can see the name <code class="docutils literal notranslate"><span class="pre">cyclops.env</span></code> was used.</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">cyclops.env</span><a class="headerlink" href="#id3" title="Permalink to this code"></a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Required field</span>
<span class="nv">JUST_PROJECT_PREFIX</span><span class="o">=</span>CYCLOPS
<span class="c1"># Highly recommended field. Just uses this to detect changes in just version.</span>
<span class="nv">JUST_VERSION</span><span class="o">=</span><span class="s2">&quot;0.2.2&quot;</span>
<span class="c1"># Recommended field</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-z<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CYCLOPS_CWD</span><span class="p">+set</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">  </span><span class="nv">CYCLOPS_CWD</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span><span class="se">\c</span>d<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span><span class="se">\d</span>irname<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">BASH_SOURCE</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&quot;</span><span class="k">)</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="se">\p</span>wd<span class="k">)</span><span class="s2">&quot;</span>
<span class="k">fi</span>
</pre></div>
</div>
</div>
<p>There are three fields you should always define in just file</p>
<ul class="simple">
<li><p><span class="target" id="index-1"></span><a class="reference internal" href="just_functions.auto.html#envvar-JUST_PROJECT_PREFIX"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">JUST_PROJECT_PREFIX</span></code></a> - Designates that environment variables that start with this prefix are special to your project. Some of the advanced <a class="reference internal" href="plugins/index.html#just-plugins"><span class="std std-ref">J.U.S.T. Plugins</span></a> use this for automatic features, and just will refuse to work without this being set.</p></li>
<li><p><span class="target" id="index-2"></span><a class="reference internal" href="just_version.auto.html#envvar-JUST_VERSION"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">JUST_VERSION</span></code></a> is recommended so that just can detect when your <a class="reference internal" href="#file-Justfile"><code class="xref bash bash-file docutils literal notranslate"><span class="pre">Justfile</span></code></a> is behind in version, so you will get a warning to updated it before updating this version number.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">${JUST_PROJECT_PREFIX}_CWD</span></code> - Some of the advanced <a class="reference internal" href="plugins/index.html#just-plugins"><span class="std std-ref">J.U.S.T. Plugins</span></a> use this for automatic features, to know where the root of your source directory is.</p></li>
</ul>
<p>After this, you are free to define any variables you like, provided they allow themselves to be overridden. A special feature of just is that all variables in this file are automatically exported for any command called by just. (Arrays are never exported because arrays simply cannot be exported to children processes). There is no need to ever says <code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">CYCLOPS_HI_FILE</span></code>, since it is already exported. All you have to do is start setting variables to be overridable. The bash notation for variables vs arrays are different for this.</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">cyclops.env continued</span><a class="headerlink" href="#id4" title="Permalink to this code"></a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># How to set variables</span>
:<span class="w"> </span><span class="si">${</span><span class="nv">CYCLOPS_HI_FILE</span><span class="p">=</span><span class="si">${</span><span class="nv">CYCLOPS_CWD</span><span class="si">}</span><span class="p">/hi.cpp</span><span class="si">}</span>
:<span class="w"> </span><span class="si">${</span><span class="nv">CYCLOPS_UID</span><span class="p">=</span><span class="k">$(</span>id<span class="w"> </span>-u<span class="k">)</span><span class="si">}</span>

<span class="c1"># How to set arrays</span>
set_array_default<span class="w"> </span>CYCLOPS_ARCH<span class="w"> </span>x86_64<span class="w"> </span>i686<span class="w"> </span>arm6
</pre></div>
</div>
</div>
<p>Both notations mean “If this variable is not set, then set it to this value. In the case of the variable:</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">=</span></code> expansion in bash means “If the variable name on the left is not set, then set the variable to the value on the right”.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">=</span></code> expansion, like all expansions in bash, is returned as a “command” or “argument” to be executed. Well we want to neither execute the value of the variable nor pass it to a command. So we use the <code class="docutils literal notranslate"><span class="pre">:</span></code> character which is a shorthand for “true”. So while this is like calling true with an argument that is ignored, this is a short and concise way to “set a variable if it doesn’t exist.</p></li>
</ul>
<p>Why was this notation not used for <code class="docutils literal notranslate"><span class="pre">CYCLOPS_CWD</span></code> above? Because in bash, the right hand side is always executed, and this can result in a time penalty, especially on Windows. Since those lines are autogenerated, they use the long form of checking.</p>
<p>There is no clean or easy way to do the same for arrays in bash, so the function <a class="reference internal" href="just_functions.auto.html#function-just_functions.bsh set_array_default"><code class="xref bash bash-func docutils literal notranslate"><span class="pre">just_functions.bsh</span> <span class="pre">set_array_default</span></code></a> is provided to accomplish the same thing, and handle all the corner cases. In this case: “If <code class="docutils literal notranslate"><span class="pre">CYCLOPS_ARCH</span></code> is unset, then it sets it to the 3 element array <code class="docutils literal notranslate"><span class="pre">(x86_64</span> <span class="pre">i686</span> <span class="pre">arm6)</span></code></p>
<p>There is no simple solution for associative arrays (because they are not bash 3.2 compatible) or noncontiguous arrays (because there has never been a need for that).</p>
<p>An additional pattern that is commonly added to the end of a project setting file, is when there are special “Non-project specific variables that executables you use” need. For example:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">PYTHONPATH</span></code> - Let’s say every call to python should have a special value for <code class="docutils literal notranslate"><span class="pre">PYTHONPATH</span></code>, then it makes sense to add that to your settings file, but only if it should be every call to python.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">OMP_NUM_THREADS</span></code> - Let’s say you are running some multi-threaded code and needed to limit the number of threads, this too would make sense to add to the special end of settings section</p></li>
<li><p>Etc… If the answers to “Is this a variable name I didn’t make up?” and “Does it make sense to set this for every program I’m going to call?” are yes, then it would be appropriate to put it here.</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">cyclops.env continued</span><a class="headerlink" href="#id5" title="Permalink to this code"></a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>:<span class="w"> </span><span class="si">${</span><span class="nv">CYCLOPS_THING1</span><span class="p">=15</span><span class="si">}</span>

<span class="c1">###############################################################################</span>
<span class="c1"># Non-CYCLOPS Settings</span>
<span class="c1">###############################################################################</span>

:<span class="w"> </span><span class="si">${</span><span class="nv">OMP_NUM_THREAD</span><span class="p">=8</span><span class="si">}</span>
:<span class="w"> </span><span class="si">${</span><span class="nv">TZ</span><span class="p">=/usr/share/zoneinfo/UTC</span><span class="si">}</span>
:<span class="w"> </span><span class="si">${</span><span class="nv">PYTHONPATH</span><span class="p">=</span><span class="si">${</span><span class="nv">CYCLOPS_CWD</span><span class="si">}</span><span class="p">/python_code</span><span class="si">}</span>
</pre></div>
</div>
</div>
<p>Some things you should never do in your settings file are:</p>
<ul class="simple">
<li><p>Output on standard error or standard out (except for debugging). It will just pollute the screen.</p></li>
<li><p>Set variables without checking if they are set first, except for <span class="target" id="index-3"></span><a class="reference internal" href="just_functions.auto.html#envvar-JUST_PROJECT_PREFIX"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">JUST_PROJECT_PREFIX</span></code></a> and <span class="target" id="index-4"></span><a class="reference internal" href="just_version.auto.html#envvar-JUST_VERSION"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">JUST_VERSION</span></code></a></p></li>
<li><p>Be fast. While you are allowed and encouraged to do anything you can do in a bash script, if you intend on taking the md5sum of a 100GB file, maybe you want to rethink when that gets done instead of doing it always (i.e. move that to a specific <a class="reference internal" href="#file-Justfile"><code class="xref bash bash-file docutils literal notranslate"><span class="pre">Justfile</span></code></a> target).</p></li>
</ul>
<dl class="bash file">
<dt class="sig sig-object bash" id="file-local.env">
<span class="sig-name descname"><span class="pre">local.env</span></span><a class="headerlink" href="#file-local.env" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="bash file">
<dt class="sig sig-object bash" id="file-local_post.env">
<span class="sig-name descname"><span class="pre">local_post.env</span></span><a class="headerlink" href="#file-local_post.env" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<p>If the project settings contain the default values, where do the the override values go? The answer is the <a class="reference internal" href="#file-local.env"><code class="xref bash bash-file docutils literal notranslate"><span class="pre">local.env</span></code></a> file. If no <a class="reference internal" href="#file-local.env"><code class="xref bash bash-file docutils literal notranslate"><span class="pre">local.env</span></code></a> file exists the first time you run just, an empty file is created for you. This is where you put the values for your “local install” of the the project. There is no need to use the same fancy notation (unless you want to make them overridable by exported variables from the terminal).</p>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">local.env</span><a class="headerlink" href="#id6" title="Permalink to this code"></a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">TZ</span><span class="o">=</span>/usr/share/zoneinfo/EST
<span class="nv">OMP_NUM_THREAD</span><span class="o">=</span><span class="m">2</span>
</pre></div>
</div>
</div>
<p>The <a class="reference internal" href="#file-local.env"><code class="xref bash bash-file docutils literal notranslate"><span class="pre">local.env</span></code></a> is loaded before the  project settings env file is loaded, so it is impossible to use any values evaluated in it. This is usually not a problem, but in those uncommon cases, that is why there is a <a class="reference internal" href="#file-local_post.env"><code class="xref bash bash-file docutils literal notranslate"><span class="pre">local_post.env</span></code></a> file. This file is used so rarely, that is not created for you by default, you’ll just need to create the empty file yourself.</p>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text">local_post.env</span><a class="headerlink" href="#id7" title="Permalink to this code"></a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">CYCLOPS_HI_FILE</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CYCLOPS_CWD</span><span class="si">}</span><span class="s2">/hi2.cpp&quot;</span>
</pre></div>
</div>
</div>
<p>Now <a class="reference internal" href="#file-local_post.env"><code class="xref bash bash-file docutils literal notranslate"><span class="pre">local_post.env</span></code></a> is run after the project settings env file is loaded, so if you changed <code class="docutils literal notranslate"><span class="pre">CYCLOPS_CWD</span></code>, any variable using its default value derived from <code class="docutils literal notranslate"><span class="pre">CYCLOPS_CWD</span></code> (e.g. <code class="docutils literal notranslate"><span class="pre">PYTHONPATH</span></code>) will not have a changed value. You will either need to set the value in the <a class="reference internal" href="#file-local.env"><code class="xref bash bash-file docutils literal notranslate"><span class="pre">local.env</span></code></a> file, or re-set every variable that derived from it in the <a class="reference internal" href="#file-local_post.env"><code class="xref bash bash-file docutils literal notranslate"><span class="pre">local_post.env</span></code></a>. Usually this is never an issue.</p>
<p>It is suggested to use the default names for the local env files, however they can be set to custom names using the <a class="reference internal" href="just_functions.auto.html#source-environment-files"><span class="std std-ref">JUST_LOCAL_SETTINGS</span></a> and <a class="reference internal" href="just_functions.auto.html#source-environment-files"><span class="std std-ref">JUST_LOCAL_SETTINGS_POST</span></a> variable. These will need to either be exported in <a class="reference internal" href="#file-setup.env"><code class="xref bash bash-file docutils literal notranslate"><span class="pre">setup.env</span></code></a> (or even somewhere like your .bashrc, depending on your use case) or set in <a class="reference internal" href="#file-Justfile"><code class="xref bash bash-file docutils literal notranslate"><span class="pre">Justfile</span></code></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <a class="reference internal" href="#file-local.env"><code class="xref bash bash-file docutils literal notranslate"><span class="pre">local.env</span></code></a> and <a class="reference internal" href="#file-local_post.env"><code class="xref bash bash-file docutils literal notranslate"><span class="pre">local_post.env</span></code></a> should never be committed to a repository. They are part of your specific configuration. Like-wise you should not be editing the project default settings env file just to customize a project on your specific computer, that should always go in the <a class="reference internal" href="#file-local.env"><code class="xref bash bash-file docutils literal notranslate"><span class="pre">local.env</span></code></a>/<a class="reference internal" href="#file-local_post.env"><code class="xref bash bash-file docutils literal notranslate"><span class="pre">local_post.env</span></code></a> files.</p>
</div>
</section>
<section id="advanced-setups">
<h2>Advanced setups<a class="headerlink" href="#advanced-setups" title="Permalink to this heading"></a></h2>
<section id="chaining-a-multiple-justfiles">
<h3>Chaining a multiple Justfiles<a class="headerlink" href="#chaining-a-multiple-justfiles" title="Permalink to this heading"></a></h3>
<p>Chaining a multiple Justfiles (usually using a submodule)</p>
<p>The main function in just is <a class="reference internal" href="#function-Justfile caseify"><code class="xref bash bash-func docutils literal notranslate"><span class="pre">Justfile</span> <span class="pre">caseify</span></code></a>, and there can only be one. The current solution to this is to make the main repo contain the <a class="reference internal" href="#function-Justfile caseify"><code class="xref bash bash-func docutils literal notranslate"><span class="pre">Justfile</span> <span class="pre">caseify</span></code></a> function, and treat the submodule as a <a class="reference internal" href="plugins/index.html#just-plugins"><span class="std std-ref">just plugin</span></a>.</p>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text">Submodule Justfile</span><a class="headerlink" href="#id8" title="Permalink to this code"></a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env bash</span>

<span class="nb">source</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">VSI_COMMON_DIR</span><span class="si">}</span><span class="s2">/linux/just_env&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>dirname<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">BASH_SOURCE</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&quot;</span><span class="k">)</span><span class="s2">&quot;</span>/<span class="s1">&#39;monocle.env&#39;</span>


<span class="c1"># Make monocle&#39;s justfile a plugin if it is not the main Justfile</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">JUSTFILE</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>!<span class="o">=</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">BASH_SOURCE</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">  </span><span class="nv">JUST_HELP_FILES</span><span class="o">+=(</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">BASH_SOURCE</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">)</span>
<span class="k">else</span>
<span class="w">  </span><span class="nb">cd</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">MONOCLE_CWD</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="c1"># Allow monocle to be run as a non-plugin too</span>
<span class="w">  </span><span class="k">function</span><span class="w"> </span>caseify<span class="o">()</span>
<span class="w">  </span><span class="o">{</span>
<span class="w">    </span>defaultify<span class="w"> </span><span class="si">${</span><span class="p">@+</span><span class="s2">&quot;</span><span class="si">${</span><span class="p">@</span><span class="si">}</span><span class="s2">&quot;</span><span class="si">}</span>
<span class="w">  </span><span class="o">}</span>
<span class="k">fi</span>

<span class="c1"># Always add this to the list, because of how the caseify above works</span>
<span class="nv">JUST_DEFAULTIFY_FUNCTIONS</span><span class="o">+=(</span>monocle_caseify<span class="o">)</span>

<span class="c1"># Main function</span>
<span class="k">function</span><span class="w"> </span>monocle_caseify<span class="o">()</span>
<span class="o">{</span>
<span class="w">  </span><span class="nb">local</span><span class="w"> </span><span class="nv">just_arg</span><span class="o">=</span><span class="nv">$1</span>
<span class="w">  </span><span class="nb">shift</span><span class="w"> </span><span class="m">1</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="si">${</span><span class="nv">just_arg</span><span class="si">}</span><span class="w"> </span><span class="k">in</span>
<span class="w">    </span>sometarget<span class="o">)</span><span class="w"> </span><span class="c1"># Do something</span>
<span class="w">      </span>ls
<span class="w">      </span><span class="p">;;</span>
<span class="w">    </span><span class="c1"># ...</span>
<span class="w">    </span>*<span class="o">)</span>
<span class="w">      </span><span class="nv">plugin_not_found</span><span class="o">=</span><span class="m">1</span>
<span class="w">      </span><span class="p">;;</span>
<span class="w">  </span><span class="k">esac</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="m">0</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<p>As you can see, the only thing that differentiates this from a plugin is a special if statement that will define <a class="reference internal" href="#function-Justfile caseify"><code class="xref bash bash-func docutils literal notranslate"><span class="pre">Justfile</span> <span class="pre">caseify</span></code></a> when it’s not already defined.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="just.auto.html" class="btn btn-neutral float-left" title="J.U.S.T." accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="just-tab.auto.html" class="btn btn-neutral float-right" title="Tab completion" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Vision Systems, Inc.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>