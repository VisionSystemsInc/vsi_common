

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>CUDA Information &mdash; VSI Common 0.2.2+1dev documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Directory Tools" href="dir_tools.auto.html" />
    <link rel="prev" title="Singularity Compatibility Variables" href="compat_singularity.auto.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> VSI Common
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../just/index.html">J.U.S.T. Useful Simple Tasking</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Linux Utilities</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="aliases.auto.html">Executable Aliases</a></li>
<li class="toctree-l2"><a class="reference internal" href="ask_question.auto.html">Ask Question</a></li>
<li class="toctree-l2"><a class="reference internal" href="bash_utils.auto.html">Bash Utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="bin_utils.auto.html">Binary Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="check_shell.auto.html">Check Shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="circular_source.auto.html">Circular source</a></li>
<li class="toctree-l2"><a class="reference internal" href="colors.auto.html">Colors Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="command_tools.auto.html">Command Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="common_source.auto.html">Common Source</a></li>
<li class="toctree-l2"><a class="reference internal" href="compat.auto.html">Compatibility Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="compat_singularity.auto.html">Singularity Compatibility Variables</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">CUDA Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="dir_tools.auto.html">Directory Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="elements.auto.html">Array Manipulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="file_tools.auto.html">File Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="findin.auto.html">Find In</a></li>
<li class="toctree-l2"><a class="reference internal" href="findinpaths.auto.html">Find In Paths</a></li>
<li class="toctree-l2"><a class="reference internal" href="git_airgap_submodule_helper.auto.html">Git Airgap Submodule Helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="git_mirror.auto.html">Git Mirror</a></li>
<li class="toctree-l2"><a class="reference internal" href="group_names.auto.html">Group Names</a></li>
<li class="toctree-l2"><a class="reference internal" href="inisin.auto.html">In Is In</a></li>
<li class="toctree-l2"><a class="reference internal" href="isin.auto.html">Is In</a></li>
<li class="toctree-l2"><a class="reference internal" href="linux_accounts.auto.html">Linux Accounts</a></li>
<li class="toctree-l2"><a class="reference internal" href="lwhich.auto.html">Lwhich</a></li>
<li class="toctree-l2"><a class="reference internal" href="mount_tools.auto.html">Mount Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="parser.auto.html">Parser</a></li>
<li class="toctree-l2"><a class="reference internal" href="pdbd.auto.html">PBDB - Primitive Bash Debugger</a></li>
<li class="toctree-l2"><a class="reference internal" href="picker.auto.html">Picker</a></li>
<li class="toctree-l2"><a class="reference internal" href="pipenv_functions.auto.html">Pipenv Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="portable_patch.auto.html">Poratble Patch</a></li>
<li class="toctree-l2"><a class="reference internal" href="postisin.auto.html">Postisin</a></li>
<li class="toctree-l2"><a class="reference internal" href="preisin.auto.html">Preisin</a></li>
<li class="toctree-l2"><a class="reference internal" href="print_command.auto.html">Print Command</a></li>
<li class="toctree-l2"><a class="reference internal" href="python_tools.auto.html">Python Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="quotemire.auto.html">Quotemire</a></li>
<li class="toctree-l2"><a class="reference internal" href="random.auto.html">Random</a></li>
<li class="toctree-l2"><a class="reference internal" href="real_path.auto.html">Real Path</a></li>
<li class="toctree-l2"><a class="reference internal" href="reisin.auto.html">Regular Expression Is In</a></li>
<li class="toctree-l2"><a class="reference internal" href="requirements.auto.html">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="set_flags.auto.html">Set Flags</a></li>
<li class="toctree-l2"><a class="reference internal" href="signal_tools.auto.html">String Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="source_once.auto.html">Source once</a></li>
<li class="toctree-l2"><a class="reference internal" href="string_tools.auto.html">String Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="time_tools.auto.html">Time Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="uwecho.auto.html">Unwrapping Echo</a></li>
<li class="toctree-l2"><a class="reference internal" href="versions.auto.html">Versions</a></li>
<li class="toctree-l2"><a class="reference internal" href="web_tools.auto.html">Web Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="yarp.auto.html">Yarp</a></li>
<li class="toctree-l2"><a class="reference internal" href="python_scripts/modules.html">Pyhton Scripts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../windows/index.html">Windows Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tests/index.html">Unit Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/modules.html">vsi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docker/recipes/get-pipenv.auto.html">Get Pipenv</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docker/recipes/index.html">Docker recipes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../style.html">Contributing Style Guide</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">VSI Common</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Linux Utilities</a> &raquo;</li>
        
      <li>CUDA Information</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/linux/cuda_info.auto.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="cuda-information">
<h1>CUDA Information<a class="headerlink" href="#cuda-information" title="Permalink to this headline">¶</a></h1>
<dl class="bash file">
<dt id="file-cuda_info.bsh">
<code class="sig-name descname"><span class="pre">cuda_info.bsh</span></code><a class="headerlink" href="#file-cuda_info.bsh" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Determine easy to use capabilities for CUDA devices</p>
<p>There are many versions of CUDA, CUDA card architectures, etc… Knowing how to compile for a specific card is hard enough, but it’s very difficult to know what the right architectures are for your specific card and what the limitations are based on your version of CUDA/NVIDIA driver, etc. This script should help determine what versions you have and suggest what architectures to use. This is good enough for an automated solution to get up and running, but these suggestions are not absolute. You may find a fine-tuned configuration that works better on a case-by-case basis.</p>
<p>A number of variables are set by the following functions.</p>
<dl class="bash var">
<dt id="var-cuda_info.bsh CUDA_VERSION">
<code class="sig-name descname"><span class="pre">CUDA_VERSION</span></code><a class="headerlink" href="#var-cuda_info.bsh CUDA_VERSION" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>The version of CUDA being used. These functions will attempt to discover the CUDA Toolkit in commonly known locations and gather a list of all discovered CUDAs in the sorted array <a class="reference internal" href="#var-cuda_info.bsh CUDA_VERSIONS"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">CUDA_VERSIONS</span></code></a>. Then, the highest capable version of CUDA is picked and set to <a class="reference internal" href="#var-cuda_info.bsh CUDA_VERSION"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">CUDA_VERSION</span></code></a>.</p>
<p><a class="reference internal" href="#var-cuda_info.bsh CUDA_VERSION"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">CUDA_VERSION</span></code></a> can optionally be set to a specific version (e.g. “7.5.13”), in which case other CUDA versions will not be discovered and <a class="reference internal" href="#var-cuda_info.bsh CUDA_VERSIONS"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">CUDA_VERSIONS</span></code></a> will not be populated.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently, CUDA Toolkits are discovered by checking the system <code class="docutils literal notranslate"><span class="pre">PATH</span></code> and <code class="docutils literal notranslate"><span class="pre">/usr/local/cuda*/bin/</span></code> directories for the nvcc executable. More paths should be added to this file as they become necessary.</p>
</div>
<dl class="bash var">
<dt id="var-cuda_info.bsh CUDA_VERSIONS">
<code class="sig-name descname"><span class="pre">CUDA_VERSIONS</span></code><a class="headerlink" href="#var-cuda_info.bsh CUDA_VERSIONS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>List of all <a class="reference internal" href="#var-cuda_info.bsh CUDA_VERSION"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">CUDA_VERSION</span></code></a>-s discovered</p>
<dl class="bash var">
<dt id="var-cuda_info.bsh CUDA_ARCHES">
<code class="sig-name descname"><span class="pre">CUDA_ARCHES</span></code><a class="headerlink" href="#var-cuda_info.bsh CUDA_ARCHES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>An array of CUDA “virtual” instruction sets supported by CUDA. Every version of CUDA (<code class="docutils literal notranslate"><span class="pre">nvcc</span></code>) has a set of “virtual” <code class="docutils literal notranslate"><span class="pre">compute_xx</span></code> architectures (ISAs) that it can build against when compiling code for “real” <code class="docutils literal notranslate"><span class="pre">sm_xx</span></code> architectures.</p>
<p>This array contains the list of the compute (virtual) architectures supported by the <a class="reference internal" href="#var-cuda_info.bsh CUDA_VERSION"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">CUDA_VERSION</span></code></a> version of CUDA as an array of two digit numbers.</p>
<p class="rubric">Example</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">echo</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">CUDA_ARCHES</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="m">20</span> <span class="m">30</span> <span class="m">32</span> <span class="m">35</span> <span class="m">37</span> <span class="m">50</span> <span class="m">52</span> <span class="m">53</span> <span class="m">60</span> <span class="m">61</span> <span class="m">62</span>

Adding the periods to the architecture version number:

<span class="nv">y</span><span class="o">=()</span>
<span class="k">for</span> x <span class="k">in</span> <span class="si">${</span><span class="nv">CUDA_ARCHES</span><span class="p">[@]+</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CUDA_ARCHES</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="si">}</span><span class="p">;</span> <span class="k">do</span>
  <span class="nv">y</span><span class="o">+=(</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">x</span><span class="p">:</span><span class="nv">0</span><span class="p">:</span><span class="si">${#</span><span class="nv">x</span><span class="si">}</span><span class="p">-1</span><span class="si">}</span><span class="s2">.</span><span class="si">${</span><span class="nv">x</span><span class="p">:</span><span class="si">${#</span><span class="nv">x</span><span class="si">}</span><span class="p">-1:</span><span class="nv">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">)</span>
<span class="k">done</span>

$ <span class="nb">echo</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">y</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="m">2</span>.0 <span class="m">3</span>.0 <span class="m">3</span>.2 <span class="m">3</span>.5 <span class="m">3</span>.7 <span class="m">5</span>.0 <span class="m">5</span>.2 <span class="m">5</span>.3 <span class="m">6</span>.0 <span class="m">6</span>.1 <span class="m">6</span>.2
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#var-cuda_info.bsh CUDA_DEPRECATED"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">CUDA_DEPRECATED</span></code></a></p>
</div>
<dl class="bash var">
<dt id="var-cuda_info.bsh CUDA_CODES">
<code class="sig-name descname"><span class="pre">CUDA_CODES</span></code><a class="headerlink" href="#var-cuda_info.bsh CUDA_CODES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>An array of CUDA “real” instruction sets supported by CUDA. Every version of CUDA (<code class="docutils literal notranslate"><span class="pre">nvcc</span></code>) has a set of “real” <code class="docutils literal notranslate"><span class="pre">sm_xx</span></code> architectures that that it can assemble native (CUDA binary) code for.</p>
<p>This array contains a list of the sm architectures supported by the <a class="reference internal" href="#var-cuda_info.bsh CUDA_VERSION"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">CUDA_VERSION</span></code></a> version of CUDA as an array of two digit numbers.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#var-cuda_info.bsh CUDA_DEPRECATED"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">CUDA_DEPRECATED</span></code></a></p>
</div>
<dl class="bash var">
<dt id="var-cuda_info.bsh CUDA_MINIMAL_DRIVER_VERSION">
<code class="sig-name descname"><span class="pre">CUDA_MINIMAL_DRIVER_VERSION</span></code><a class="headerlink" href="#var-cuda_info.bsh CUDA_MINIMAL_DRIVER_VERSION" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Every version of CUDA has a minimal version of the NVIDIA graphics-card driver that must be installed in order to support that version of CUDA. This was largely undocumented until CUDA 10 came out, despite being obviously important. This variable is set to the minimum required version of the NVIDIA driver for the <a class="reference internal" href="#var-cuda_info.bsh CUDA_VERSION"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">CUDA_VERSION</span></code></a> version of CUDA, as best as we’ve been able to determine.</p>
<dl class="bash var">
<dt id="var-cuda_info.bsh CUDA_DEPRECATED">
<code class="sig-name descname"><span class="pre">CUDA_DEPRECATED</span></code><a class="headerlink" href="#var-cuda_info.bsh CUDA_DEPRECATED" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Some versions of CUDA support old instruction sets, but print a deprecated warning. For those versions of CUDA, a <a class="reference internal" href="#var-cuda_info.bsh CUDA_DEPRECATED"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">CUDA_DEPRECATED</span></code></a> array is defined to list the two digit architectures that are supported yet deprecated in the <a class="reference internal" href="#var-cuda_info.bsh CUDA_VERSION"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">CUDA_VERSION</span></code></a> version of CUDA.</p>
<dl class="bash var">
<dt id="var-cuda_info.bsh CUDA_FORWARD_PTX">
<code class="sig-name descname"><span class="pre">CUDA_FORWARD_PTX</span></code><a class="headerlink" href="#var-cuda_info.bsh CUDA_FORWARD_PTX" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>PTX arch for newer CUDA cards. In situations where you are making portable fatbinaries, you should compile for every architecture. However, in order to future proof your fatbin for architectures newer than your current version of CUDA supports, you will need to compile to a pure virtual architecture using the PTX feature so that the real architecture can be JIT (Just-In-Time) compiled.</p>
<p><a class="reference internal" href="#var-cuda_info.bsh CUDA_FORWARD_PTX"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">CUDA_FORWARD_PTX</span></code></a> identifies the fullest-featured PTX architecture so that you can choose to add this to your builds.</p>
<dl class="bash var">
<dt id="var-cuda_info.bsh CUDA_CARDS">
<code class="sig-name descname"><span class="pre">CUDA_CARDS</span></code><a class="headerlink" href="#var-cuda_info.bsh CUDA_CARDS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>The names of the CUDA cards. Exact values may vary, e.g. “Titan X (Pascal)” vs “Titan Xp”.</p>
<dl class="bash var">
<dt id="var-cuda_info.bsh CUDA_CARD_FAMILIES">
<code class="sig-name descname"><span class="pre">CUDA_CARD_FAMILIES</span></code><a class="headerlink" href="#var-cuda_info.bsh CUDA_CARD_FAMILIES" title="Permalink to this definition">¶</a></dt>
<dd><p>The family name of each card in <a class="reference internal" href="#var-cuda_info.bsh CUDA_CARDS"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">CUDA_CARDS</span></code></a>.</p>
</dd></dl>

<dl class="bash var">
<dt id="var-cuda_info.bsh CUDA_CARD_ARCHES">
<code class="sig-name descname"><span class="pre">CUDA_CARD_ARCHES</span></code><a class="headerlink" href="#var-cuda_info.bsh CUDA_CARD_ARCHES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>The specific CUDA architecture a card natively supports, for each card in <a class="reference internal" href="#var-cuda_info.bsh CUDA_CARDS"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">CUDA_CARDS</span></code></a>.</p>
<dl class="bash var">
<dt id="var-cuda_info.bsh CUDA_SUGGESTED_ARCHES">
<code class="sig-name descname"><span class="pre">CUDA_SUGGESTED_ARCHES</span></code><a class="headerlink" href="#var-cuda_info.bsh CUDA_SUGGESTED_ARCHES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Suggested “virtual” architectures to compile for. Instead of compiling for every architecture that the <a class="reference internal" href="#var-cuda_info.bsh CUDA_VERSION"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">CUDA_VERSION</span></code></a> version of CUDA supports, <a class="reference internal" href="#var-cuda_info.bsh CUDA_SUGGESTED_ARCHES"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">CUDA_SUGGESTED_ARCHES</span></code></a> is the intersection between <a class="reference internal" href="#var-cuda_info.bsh CUDA_CARD_ARCHES"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">CUDA_CARD_ARCHES</span></code></a> and <a class="reference internal" href="#var-cuda_info.bsh CUDA_ARCHES"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">CUDA_ARCHES</span></code></a> so that you compile only for your cards.</p>
<dl class="bash var">
<dt id="var-cuda_info.bsh CUDA_SUGGESTED_CODES">
<code class="sig-name descname"><span class="pre">CUDA_SUGGESTED_CODES</span></code><a class="headerlink" href="#var-cuda_info.bsh CUDA_SUGGESTED_CODES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Suggested “real” architectures to compile for. Instead of compiling for every architecture that the <a class="reference internal" href="#var-cuda_info.bsh CUDA_VERSION"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">CUDA_VERSION</span></code></a> version of CUDA supports, <a class="reference internal" href="#var-cuda_info.bsh CUDA_SUGGESTED_CODES"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">CUDA_SUGGESTED_CODES</span></code></a> is the intersection between <a class="reference internal" href="#var-cuda_info.bsh CUDA_CARD_ARCHES"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">CUDA_CARD_ARCHES</span></code></a> and <a class="reference internal" href="#var-cuda_info.bsh CUDA_CODES"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">CUDA_CODES</span></code></a> so that you compile only for your cards.</p>
<dl class="bash var">
<dt id="var-cuda_info.bsh CUDA_SUGGESTED_PTX">
<code class="sig-name descname"><span class="pre">CUDA_SUGGESTED_PTX</span></code><a class="headerlink" href="#var-cuda_info.bsh CUDA_SUGGESTED_PTX" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Suggested PTX architectures to compile for. If your graphics card is too new for the <a class="reference internal" href="#var-cuda_info.bsh CUDA_VERSION"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">CUDA_VERSION</span></code></a> version of CUDA, you will need to compile to a pure virtual architecture (by embedding PTX code in the fatbinary) in order to use it. That way, the real architecture can be JIT (Just-In-Time) compiled for at runtime.</p>
<p><a class="reference internal" href="#var-cuda_info.bsh CUDA_SUGGESTED_PTX"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">CUDA_SUGGESTED_PTX</span></code></a> identifies the PTX architectures you need to run on newer (unrecognized) cards. You can choose to add them to your builds.</p>
<dl class="bash function">
<dt id="function-cuda_info.bsh discover_cuda_versions">
<code class="sig-name descname"><span class="pre">discover_cuda_versions</span></code><a class="headerlink" href="#function-cuda_info.bsh discover_cuda_versions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Output</dt>
<dd class="field-odd"><p><a class="reference internal" href="#var-cuda_info.bsh CUDA_VERSIONS"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">cuda_info.bsh</span> <span class="pre">CUDA_VERSIONS</span></code></a>
<a class="reference internal" href="#var-cuda_info.bsh CUDA_VERSION"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">cuda_info.bsh</span> <span class="pre">CUDA_VERSION</span></code></a></p>
</dd>
</dl>
<p>Find CUDA development kits</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Will not work on macOS if it has NVIDIA and two or more versions of CUDA installed.</p>
</div>
<dl class="bash function">
<dt id="function-cuda_info.bsh nvidia_smi_cuda_version">
<code class="sig-name descname"><span class="pre">nvidia_smi_cuda_version</span></code><a class="headerlink" href="#function-cuda_info.bsh nvidia_smi_cuda_version" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Starting at NVIDIA Driver version 410.72, <code class="docutils literal notranslate"><span class="pre">nvidia-smi</span></code> started listing the maximum version of CUDA that driver supports. This function can be used to parse that.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">NVIDIA_SMI</span></code> - Optional path to a specific <code class="docutils literal notranslate"><span class="pre">nvidia-smi</span></code>. Default: <code class="docutils literal notranslate"><span class="pre">nvidia-smi</span></code> (using the system path)</p></li>
</ul>
</dd>
<dt class="field-even">Output</dt>
<dd class="field-even"><p><em>stdout</em> - echoes out the version of CUDA that <code class="docutils literal notranslate"><span class="pre">nvidia-smi</span></code> says it supports. If this version of <code class="docutils literal notranslate"><span class="pre">nvidia-smi</span></code> does not say, nothing is output.</p>
</dd>
</dl>
<dl class="bash function">
<dt id="function-cuda_info.bsh device_query_cuda_capability">
<code class="sig-name descname"><span class="pre">device_query_cuda_capability</span></code><a class="headerlink" href="#function-cuda_info.bsh device_query_cuda_capability" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Output</dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference internal" href="#var-cuda_info.bsh CUDA_CARD_FAMILIES"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">cuda_info.bsh</span> <span class="pre">CUDA_CARD_FAMILIES</span></code></a></p></li>
<li><p><a class="reference internal" href="#var-cuda_info.bsh CUDA_CARD_ARCHES"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">cuda_info.bsh</span> <span class="pre">CUDA_CARD_ARCHES</span></code></a></p></li>
<li><p><a class="reference internal" href="#var-cuda_info.bsh CUDA_CARDS"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">cuda_info.bsh</span> <span class="pre">CUDA_CARDS</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">DEVICE_QUERY</span></code> - Optional path to a specific <code class="docutils literal notranslate"><span class="pre">deviceQuery</span></code>. Default: <code class="docutils literal notranslate"><span class="pre">deviceQuery</span></code> (using the system path)</p></li>
</ul>
</dd>
<dt class="field-odd">Return Value</dt>
<dd class="field-odd"><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">0</span></code> - No errors</p></li>
<li><p>Non-zero - If the output of <code class="docutils literal notranslate"><span class="pre">deviceQuery</span></code> does not contain any CUDA capabilities, then something likely failed. This is usually caused by running a contianer without the NVIDIA extensions or having an insufficient NVIDIA driver for the version of CUDA <code class="docutils literal notranslate"><span class="pre">deviceQuery</span></code> is compiled for.</p></li>
</ul>
</dd>
</dl>
<p>Device query is one of the sample programs in the CUDA Samples that prints out useful information about the connected CUDA devices.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">deviceQuery</span></code> executable is compiled from the source code typically found the in <code class="docutils literal notranslate"><span class="pre">/usr/local/cuda/samples/1_Utilities/deviceQuery/</span></code>, but can be downloaded precompiled for Linux from <a class="reference external" href="https://goo.gl/equvX3">https://goo.gl/equvX3</a></p>
<dl class="bash function">
<dt id="function-cuda_info.bsh nvidia_docker_plugin_cuda_capability">
<code class="sig-name descname"><span class="pre">nvidia_docker_plugin_cuda_capability</span></code><a class="headerlink" href="#function-cuda_info.bsh nvidia_docker_plugin_cuda_capability" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>The deprecated nvidia-docker v1 API actually hosted GPU information, which was useful for determining the CUDA Arches. This is rarely used now.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p>[<code class="docutils literal notranslate"><span class="pre">NV_HOST</span></code>] - Environment variable to optionally specify a custom NVIDIA host for the GPUs. Default: <code class="docutils literal notranslate"><span class="pre">http://localhost:3476</span></code></p>
</dd>
<dt class="field-even">Output</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference internal" href="#var-cuda_info.bsh CUDA_CARD_FAMILIES"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">cuda_info.bsh</span> <span class="pre">CUDA_CARD_FAMILIES</span></code></a></p></li>
<li><p><a class="reference internal" href="#var-cuda_info.bsh CUDA_CARD_ARCHES"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">cuda_info.bsh</span> <span class="pre">CUDA_CARD_ARCHES</span></code></a></p></li>
<li><p><a class="reference internal" href="#var-cuda_info.bsh CUDA_CARDS"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">cuda_info.bsh</span> <span class="pre">CUDA_CARDS</span></code></a></p></li>
</ul>
</dd>
</dl>
<dl class="bash function">
<dt id="function-cuda_info.bsh cuda_arch_to_cuda_family">
<code class="sig-name descname"><span class="pre">cuda_arch_to_cuda_family</span></code><a class="headerlink" href="#function-cuda_info.bsh cuda_arch_to_cuda_family" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Determines CUDA Family names based off of CUDA Arch stored in <code class="docutils literal notranslate"><span class="pre">CUDA_CARD_ARCHES</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><a class="reference internal" href="#var-cuda_info.bsh CUDA_CARD_ARCHES"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">cuda_info.bsh</span> <span class="pre">CUDA_CARD_ARCHES</span></code></a></p>
</dd>
<dt class="field-even">Output</dt>
<dd class="field-even"><p><a class="reference internal" href="#var-cuda_info.bsh CUDA_CARD_FAMILIES"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">cuda_info.bsh</span> <span class="pre">CUDA_CARD_FAMILIES</span></code></a></p>
</dd>
</dl>
<dl class="bash function">
<dt id="function-cuda_info.bsh discover_cuda_info">
<code class="sig-name descname"><span class="pre">discover_cuda_info</span></code><a class="headerlink" href="#function-cuda_info.bsh discover_cuda_info" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Get CUDA info about each card</p>
<dl class="field-list simple">
<dt class="field-odd">Output</dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference internal" href="#var-cuda_info.bsh CUDA_CARDS"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">cuda_info.bsh</span> <span class="pre">CUDA_CARDS</span></code></a></p></li>
<li><p><a class="reference internal" href="#var-cuda_info.bsh CUDA_CARD_ARCHES"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">cuda_info.bsh</span> <span class="pre">CUDA_CARD_ARCHES</span></code></a></p></li>
<li><p><a class="reference internal" href="#var-cuda_info.bsh CUDA_CARD_FAMILIES"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">cuda_info.bsh</span> <span class="pre">CUDA_CARD_FAMILIES</span></code></a></p></li>
</ul>
</dd>
</dl>
<dl class="bash function">
<dt id="function-cuda_info.bsh cuda_capabilities">
<code class="sig-name descname"><span class="pre">cuda_capabilities</span></code><a class="headerlink" href="#function-cuda_info.bsh cuda_capabilities" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">$1</span></code> - The CUDA version to check against. This is typically the <code class="docutils literal notranslate"><span class="pre">nvcc</span></code> version, but the docs version should work too. In a pinch, CUDA version will work, to some extent.</p>
</dd>
<dt class="field-even">Output</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference internal" href="#var-cuda_info.bsh CUDA_ARCHES"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">cuda_info.bsh</span> <span class="pre">CUDA_ARCHES</span></code></a></p></li>
<li><p><a class="reference internal" href="#var-cuda_info.bsh CUDA_CODES"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">cuda_info.bsh</span> <span class="pre">CUDA_CODES</span></code></a></p></li>
<li><p><a class="reference internal" href="#var-cuda_info.bsh CUDA_MINIMAL_DRIVER_VERSION"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">cuda_info.bsh</span> <span class="pre">CUDA_MINIMAL_DRIVER_VERSION</span></code></a></p></li>
<li><p><a class="reference internal" href="#var-cuda_info.bsh CUDA_DEPRECATED"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">cuda_info.bsh</span> <span class="pre">CUDA_DEPRECATED</span></code></a></p></li>
</ul>
</dd>
</dl>
<p>Determine compiler capabilities for specific CDK</p>
<dl class="bash function">
<dt id="function-cuda_info.bsh suggested_architectures">
<code class="sig-name descname"><span class="pre">suggested_architectures</span></code><a class="headerlink" href="#function-cuda_info.bsh suggested_architectures" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Output</dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference internal" href="#var-cuda_info.bsh CUDA_SUGGESTED_ARCHES"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">cuda_info.bsh</span> <span class="pre">CUDA_SUGGESTED_ARCHES</span></code></a></p></li>
<li><p><a class="reference internal" href="#var-cuda_info.bsh CUDA_SUGGESTED_CODES"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">cuda_info.bsh</span> <span class="pre">CUDA_SUGGESTED_CODES</span></code></a></p></li>
<li><p><a class="reference internal" href="#var-cuda_info.bsh CUDA_SUGGESTED_PTX"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">cuda_info.bsh</span> <span class="pre">CUDA_SUGGESTED_PTX</span></code></a></p></li>
<li><p><a class="reference internal" href="#var-cuda_info.bsh CUDA_FORWARD_PTX"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">cuda_info.bsh</span> <span class="pre">CUDA_FORWARD_PTX</span></code></a></p></li>
</ul>
</dd>
</dl>
<p>Calculate suggested architectures</p>
<dl class="bash function">
<dt id="function-cuda_info.bsh cmake_cuda_flags">
<code class="sig-name descname"><span class="pre">cmake_cuda_flags</span></code><a class="headerlink" href="#function-cuda_info.bsh cmake_cuda_flags" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference internal" href="#var-cuda_info.bsh CUDA_SUGGESTED_ARCHES"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">cuda_info.bsh</span> <span class="pre">CUDA_SUGGESTED_ARCHES</span></code></a></p></li>
<li><p><a class="reference internal" href="#var-cuda_info.bsh CUDA_SUGGESTED_CODES"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">cuda_info.bsh</span> <span class="pre">CUDA_SUGGESTED_CODES</span></code></a></p></li>
<li><p>[<a class="reference internal" href="#var-cuda_info.bsh CUDA_SUGGESTED_PTX"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">cuda_info.bsh</span> <span class="pre">CUDA_SUGGESTED_PTX</span></code></a>]</p></li>
</ul>
</dd>
<dt class="field-even">Output</dt>
<dd class="field-even"><p><em>stdout</em> - echoes out the value of the target_CUDA_architectures</p>
</dd>
</dl>
<p>Generate CUDA flags for CMake</p>
<p>Modern CMake installs include a FindCUDA.cmake script which calls the select_compute_arch.cmake script (<a class="reference external" href="https://goo.gl/uZvAjR">https://goo.gl/uZvAjR</a>). It uses a limited version of the tables that <a class="reference internal" href="#file-cuda_info.bsh"><code class="xref bash bash-file docutils literal notranslate"><span class="pre">cuda_info.bsh</span></code></a> uses and is prone to being out of date.</p>
<p>This function will calculate the suggested value of target_CUDA_architectures for CMake’s:</p>
<blockquote>
<div><p>FindCUDA.cmake:select_compute_arch.cmake:CUDA_SELECT_NVCC_ARCH_FLAGS</p>
</div></blockquote>
<p>You will need to find where this is used and set the variable accordingly.</p>
<p class="rubric">Example</p>
<p>For example, PyTorch’s CMake contains:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>CUDA_SELECT_NVCC_ARCH_FLAGS<span class="o">(</span>NVCC_FLAGS_EXTRA <span class="nv">$ENV</span><span class="o">{</span>TORCH_CUDA_ARCH_LIST<span class="o">})</span>
</pre></div>
</div>
<p>Setting the environment variable <code class="docutils literal notranslate"><span class="pre">TORCH_CUDA_ARCH_LIST</span></code> to the output of <a class="reference internal" href="#function-cuda_info.bsh cmake_cuda_flags"><code class="xref bash bash-func docutils literal notranslate"><span class="pre">cmake_cuda_flags</span></code></a> will result in using the desired CUDA architecture and code versions.</p>
<p>To add the <a class="reference internal" href="#var-cuda_info.bsh CUDA_FORWARD_PTX"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">cuda_info.bsh</span> <span class="pre">CUDA_FORWARD_PTX</span></code></a>, run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">CUDA_SUGGESTED_PTX</span><span class="o">+=(</span><span class="si">${</span><span class="nv">CUDA_FORWARD_PTX</span><span class="si">}</span><span class="o">)</span>
</pre></div>
</div>
<p>before calling <a class="reference internal" href="#function-cuda_info.bsh cmake_cuda_flags"><code class="xref bash bash-func docutils literal notranslate"><span class="pre">cmake_cuda_flags</span></code></a></p>
<dl class="bash function">
<dt id="function-cuda_info.bsh discover_cuda_all">
<code class="sig-name descname"><span class="pre">discover_cuda_all</span></code><a class="headerlink" href="#function-cuda_info.bsh discover_cuda_all" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Helper function to call all the discovery code in one call.</p>
<p>There are two methods for CUDA device discovery (in order):</p>
<ol class="arabic simple">
<li><p>Using deviceQuery (available here <a class="reference external" href="https://goo.gl/ocBgPU">https://goo.gl/ocBgPU</a>)</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>looks for ${DEVICE_QUERY-deviceQuery} on the PATH</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Using the nvidia-docker-plugin to get and parse GPU information</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>discovered using either <code class="docutils literal notranslate"><span class="pre">NV_HOST</span></code> or checking to see if nvidia-docker-plugin is running locally using pgrep or ps</p></li>
</ul>
</div></blockquote>
<p>When running in a docker, deviceQuery is the preferred method. <code class="docutils literal notranslate"><span class="pre">NV_HOST</span></code> could be used, but that involves telling the docker the IP of the host, or using a shared network mode in order to use localhost (which is not recommended for production). Attempting to discover nvidia-docker-plugin will not work in a docker.</p>
<dl class="field-list simple">
<dt class="field-odd">Output</dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference internal" href="#var-cuda_info.bsh CUDA_CARDS"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">cuda_info.bsh</span> <span class="pre">CUDA_CARDS</span></code></a></p></li>
<li><p><a class="reference internal" href="#var-cuda_info.bsh CUDA_CARD_ARCHES"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">cuda_info.bsh</span> <span class="pre">CUDA_CARD_ARCHES</span></code></a></p></li>
<li><p><a class="reference internal" href="#var-cuda_info.bsh CUDA_CARD_FAMILIES"><code class="xref bash bash-var docutils literal notranslate"><span class="pre">cuda_info.bsh</span> <span class="pre">CUDA_CARD_FAMILIES</span></code></a></p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If deviceQuery is not used, then an internal lookup table is used, but only supports Tesla, Fermi, Kepler, Maxwell, Pascal, Volta, Tesla, and Ampere. Additional family names need to be added as they are released.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="dir_tools.auto.html" class="btn btn-neutral float-right" title="Directory Tools" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="compat_singularity.auto.html" class="btn btn-neutral float-left" title="Singularity Compatibility Variables" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Vision Systems, Inc.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>