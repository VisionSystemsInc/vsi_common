

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>CUDA Information &mdash; VSI Common 0.2.2+1dev documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Directory Tools" href="dir_tools.auto.html" />
    <link rel="prev" title="Common Source" href="common_source.auto.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> VSI Common
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../just/index.html">J.U.S.T. Useful Simple Tasking</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Linux Utilities</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="aliases.auto.html">Executable Aliases</a></li>
<li class="toctree-l2"><a class="reference internal" href="ask_question.auto.html">Ask Question</a></li>
<li class="toctree-l2"><a class="reference internal" href="bin_utils.auto.html">Binary Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="check_shell.auto.html">Check Shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="circular_source.auto.html">Circular source</a></li>
<li class="toctree-l2"><a class="reference internal" href="colors.auto.html">Colors Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="command_tools.auto.html">Command Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="common_source.auto.html">Common Source</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">CUDA Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="dir_tools.auto.html">Directory Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="elements.auto.html">Array Manipulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="file_tools.auto.html">File Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="findin.auto.html">Find In</a></li>
<li class="toctree-l2"><a class="reference internal" href="findinpaths.auto.html">Find In Paths</a></li>
<li class="toctree-l2"><a class="reference internal" href="git_airgap_submodule_helper.auto.html">Git Airgap Submodule Helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="git_mirror.auto.html">Git Mirror</a></li>
<li class="toctree-l2"><a class="reference internal" href="group_names.auto.html">Group Names</a></li>
<li class="toctree-l2"><a class="reference internal" href="inisin.auto.html">In Is In</a></li>
<li class="toctree-l2"><a class="reference internal" href="isin.auto.html">Is In</a></li>
<li class="toctree-l2"><a class="reference internal" href="linux_accounts.auto.html">Linux Accounts</a></li>
<li class="toctree-l2"><a class="reference internal" href="lwhich.auto.html">Lwhich</a></li>
<li class="toctree-l2"><a class="reference internal" href="mount_tools.auto.html">Mount Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="parser.auto.html">Parser</a></li>
<li class="toctree-l2"><a class="reference internal" href="pdbd.auto.html">PBDB - Primitive Bash Debugger</a></li>
<li class="toctree-l2"><a class="reference internal" href="picker.auto.html">Picker</a></li>
<li class="toctree-l2"><a class="reference internal" href="pipenv_functions.auto.html">Pipenv Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="postisin.auto.html">Postisin</a></li>
<li class="toctree-l2"><a class="reference internal" href="preisin.auto.html">Preisin</a></li>
<li class="toctree-l2"><a class="reference internal" href="print_command.auto.html">Print Command</a></li>
<li class="toctree-l2"><a class="reference internal" href="python_tools.auto.html">Python Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="quotemire.auto.html">Quotemire</a></li>
<li class="toctree-l2"><a class="reference internal" href="random.auto.html">Random</a></li>
<li class="toctree-l2"><a class="reference internal" href="real_path.auto.html">Real Path</a></li>
<li class="toctree-l2"><a class="reference internal" href="requirements.auto.html">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="set_flags.auto.html">Set Flags</a></li>
<li class="toctree-l2"><a class="reference internal" href="signal_tools.auto.html">String Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="source_once.auto.html">Source once</a></li>
<li class="toctree-l2"><a class="reference internal" href="string_tools.auto.html">String Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="time_tools.auto.html">Time Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="uwecho.auto.html">Unwrapping Echo</a></li>
<li class="toctree-l2"><a class="reference internal" href="web_tools.auto.html">Web Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="yarp.auto.html">Yarp</a></li>
<li class="toctree-l2"><a class="reference internal" href="python_scripts/modules.html">Pyhton Scripts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../windows/index.html">Windows Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tests/index.html">Unit Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/modules.html">vsi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docker/recipes/get-pipenv.auto.html">Get Pipenv</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docker/recipes/index.html">Docker recipes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../style.html">Contributing Style Guide</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">VSI Common</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Linux Utilities</a> &raquo;</li>
        
      <li>CUDA Information</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/linux/cuda_info.auto.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="cuda-information">
<h1>CUDA Information<a class="headerlink" href="#cuda-information" title="Permalink to this headline">¶</a></h1>
<dl class="bash file">
<dt id="file-cuda_info.bsh">
<code class="sig-name descname">cuda_info.bsh</code><a class="headerlink" href="#file-cuda_info.bsh" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Determine easy to use capabilities for <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> devices</p>
<p>There are many versions of <code class="docutils literal notranslate"><span class="pre">CUDA</span></code>, <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> card architectures, etc… Knowing how to compile for a specific card is hard enough, but it’s very difficult to know what the right architectures are for your specific card and what the limitations are based on your version of <code class="docutils literal notranslate"><span class="pre">CUDA/NVIDIA</span></code> driver, etc. This script should help determine what versions you have and suggest what architectures to use. This is good enough for an automated solution to get up and running, but these suggestions are not absolute. You may find a fine-tuned configuration that works better on a case-by-case basis.</p>
<dl class="std envvar">
<dt id="envvar-CUDA_VERSION">
<code class="sig-name descname">CUDA_VERSION</code><a class="headerlink" href="#envvar-CUDA_VERSION" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>The version of <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> being used</p>
<p><a class="reference internal" href="#file-cuda_info.bsh"><code class="xref bash bash-file docutils literal notranslate"><span class="pre">cuda_info.bsh</span></code></a> will attempt to discover the <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> Development Kit in commonly known locations, and accumulate a list of all discovered CDKs in the sorted array CUDA_VERSIONS. Then, the highest capable version of <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> is picked and set to <span class="target" id="index-0"></span><a class="reference internal" href="#envvar-CUDA_VERSION"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_VERSION</span></code></a>.</p>
<p><span class="target" id="index-1"></span><a class="reference internal" href="#envvar-CUDA_VERSION"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_VERSION</span></code></a> can optionally be set to a specific version (e.g. “7.5.13”), in which case other <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> versions will not be discovered and <code class="docutils literal notranslate"><span class="pre">CUDA_VERSIONS</span></code> will not be populated.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently, CDKs are discovered by checking the system PATH and /usr/local/cuda*/bin/ directories for the nvcc executable. More paths should be added to this file as they become necessary.</p>
</div>
<dl class="bash function">
<dt id="function-cuda_info.bsh discover_cuda_versions">
<code class="sig-name descname">discover_cuda_versions</code><a class="headerlink" href="#function-cuda_info.bsh discover_cuda_versions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Output</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">CUDA_VERSIONS</span></code> - List of <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> versions found</p>
</dd>
</dl>
<p>Find <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> development kits</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Will not work on macosx if mac have nvidia and two or more versions of cuda
installed. Seems unlikely</p>
</div>
<dl class="std envvar">
<dt id="envvar-CUDA_DISCOVER">
<code class="sig-name descname">CUDA_DISCOVER</code><a class="headerlink" href="#envvar-CUDA_DISCOVER" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Parameter</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">CUDA_DISCOVER</span></code> - Default is disabled, set to <code class="docutils literal notranslate"><span class="pre">1</span></code> to enable.</p>
</dd>
</dl>
<p>Flag to enable the discovery of CUDA cards and capabilities</p>
<p>Because the <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> card discovery can be expensive (milliseconds on some computers, hundreds on others), it is disabled by default.</p>
<dl>
<dt>There are two methods for CUDA device discovery (in order):</dt><dd><ol class="arabic simple">
<li><p>Using deviceQuery (available here <a class="reference external" href="https://goo.gl/ocBgPU">https://goo.gl/ocBgPU</a>)</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>looks for ${DEVICE_QUERY-deviceQuery} on the PATH</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Using the nvidia-docker-plugin to get and parse GPU information</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>discovered using either <code class="docutils literal notranslate"><span class="pre">NV_HOST</span></code> or checking to see if nvidia-docker-plugin is running locally using pgrep or ps</p></li>
</ul>
</div></blockquote>
</dd>
</dl>
<p>When running in a docker, deviceQuery is the preferred method. <code class="docutils literal notranslate"><span class="pre">NV_HOST</span></code> could be used, but that involves telling the docker the IP of the host, or using a shared network mode in order to use localhost (which is not recommended for production). Attempting to discover nvidia-docker-plugin will not work in a docker.</p>
<dl class="std envvar">
<dt id="envvar-CUDA_CARDS">
<code class="sig-name descname">CUDA_CARDS</code><a class="headerlink" href="#envvar-CUDA_CARDS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>List of <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> devices found on the computer</p>
<p>An array of all the <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> cards discovered. The only way to manually override this would be to disable <span class="target" id="index-2"></span><a class="reference internal" href="#envvar-CUDA_DISCOVER"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_DISCOVER</span></code></a>, but that was not the intended use.</p>
<dl class="std envvar">
<dt id="envvar-CUDA_CARD_ARCHES">
<code class="sig-name descname">CUDA_CARD_ARCHES</code><a class="headerlink" href="#envvar-CUDA_CARD_ARCHES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>List of <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> card architectures</p>
<p>An array of all the architectures the <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> cards discovered. The only way to manually override this would be to disable <span class="target" id="index-3"></span><a class="reference internal" href="#envvar-CUDA_DISCOVER"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_DISCOVER</span></code></a>, but that was not the intended use.</p>
<dl class="std envvar">
<dt id="envvar-CUDA_CARD_FAMILIES">
<code class="sig-name descname">CUDA_CARD_FAMILIES</code><a class="headerlink" href="#envvar-CUDA_CARD_FAMILIES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>List of <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> card family names</p>
<p>An array of all the family names of the <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> cards discovered. The only way to manually override this would be to disable <span class="target" id="index-4"></span><a class="reference internal" href="#envvar-CUDA_DISCOVER"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_DISCOVER</span></code></a>, but that was not the intended use.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If deviceQuery is not used, then an internal lookup table is used, but only supports Tesla, Fermi, Kepler, Maxwell, Pascal, and Volta. Additional family names need to be added as they are released.</p>
</div>
<dl class="bash function">
<dt id="function-cuda_info.bsh discover_cuda_info">
<code class="sig-name descname">discover_cuda_info</code><a class="headerlink" href="#function-cuda_info.bsh discover_cuda_info" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Output</dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="index-5"></span><a class="reference internal" href="#envvar-CUDA_CARDS"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_CARDS</span></code></a> - List of all <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> capable devices</p></li>
<li><p><span class="target" id="index-6"></span><a class="reference internal" href="#envvar-CUDA_CARD_ARCHES"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_CARD_ARCHES</span></code></a> - Matching list of <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> real architectures</p></li>
<li><p><span class="target" id="index-7"></span><a class="reference internal" href="#envvar-CUDA_CARD_FAMILIES"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_CARD_FAMILIES</span></code></a> - Matching list of <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> families</p></li>
</ul>
</dd>
</dl>
<p>Get <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> info about each card</p>
<dl class="std envvar">
<dt id="envvar-DEVICE_QUERY">
<code class="sig-name descname">DEVICE_QUERY</code><a class="headerlink" href="#envvar-DEVICE_QUERY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Name of the device query executable</p>
<p class="rubric">Usage</p>
<p>Optional override for the name of the executable for device query. Device query is one of the sample programs in the <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> Development Kit that prints out useful information about the connected <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> devices.</p>
<p><span class="target" id="index-8"></span><a class="reference internal" href="#envvar-DEVICE_QUERY"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">DEVICE_QUERY</span></code></a> defaults to “deviceQuery” and must either be on the PATH or be an absolute path.</p>
<p>The deviceQuery executable is compiled from the source code typically found the in /usr/local/cuda/samples/1_Utilities/deviceQuery/ directory, but can be downloaded precompiled for Linux from <a class="reference external" href="https://goo.gl/equvX3">https://goo.gl/equvX3</a></p>
<dl class="std envvar">
<dt id="envvar-CUDA_ARCHES">
<code class="sig-name descname">CUDA_ARCHES</code><a class="headerlink" href="#envvar-CUDA_ARCHES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>List of <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> “virtual” instruction sets supported by <code class="docutils literal notranslate"><span class="pre">CUDA</span></code></p>
<p>Every version of <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> (nvcc) has a set of “virtual” compute_xx architectures (ISAs) that it can build against when compiling code for “real” sm_xx architectures.</p>
<p>This array contains the list of the compute (virtual) architectures supported by the <span class="target" id="index-9"></span><a class="reference internal" href="#envvar-CUDA_VERSION"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_VERSION</span></code></a> version of <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> as an array of two digit numbers.</p>
<p class="rubric">Example</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>  $ <span class="nb">echo</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">CUDA_ARCHES</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
  <span class="m">20</span> <span class="m">30</span> <span class="m">32</span> <span class="m">35</span> <span class="m">37</span> <span class="m">50</span> <span class="m">52</span> <span class="m">53</span> <span class="m">60</span> <span class="m">61</span> <span class="m">62</span>

Adding the periods to the architecture version number:

<span class="nv">y</span><span class="o">=()</span>
<span class="k">for</span> x in <span class="si">${</span><span class="nv">CUDA_ARCHES</span><span class="p">+</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CUDA_ARCHES</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="si">}</span><span class="p">;</span> <span class="k">do</span>
  <span class="nv">y</span><span class="o">+=(</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">x</span><span class="p">:</span><span class="nv">0</span><span class="p">:</span><span class="si">${#</span><span class="nv">x</span><span class="si">}</span><span class="p">-1</span><span class="si">}</span><span class="s2">.</span><span class="si">${</span><span class="nv">x</span><span class="p">:</span><span class="si">${#</span><span class="nv">x</span><span class="si">}</span><span class="p">-1:</span><span class="nv">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">)</span>
<span class="k">done</span>

$ <span class="nb">echo</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">y</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="m">2</span>.0 <span class="m">3</span>.0 <span class="m">3</span>.2 <span class="m">3</span>.5 <span class="m">3</span>.7 <span class="m">5</span>.0 <span class="m">5</span>.2 <span class="m">5</span>.3 <span class="m">6</span>.0 <span class="m">6</span>.1 <span class="m">6</span>.2
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><span class="target" id="index-10"></span><a class="reference internal" href="#envvar-CUDA_DEPRECATED"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_DEPRECATED</span></code></a></p>
</div>
<dl class="std envvar">
<dt id="envvar-CUDA_CODES">
<code class="sig-name descname">CUDA_CODES</code><a class="headerlink" href="#envvar-CUDA_CODES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>List of <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> “real” instruction sets supported by <code class="docutils literal notranslate"><span class="pre">CUDA</span></code></p>
<p>Every version of <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> (nvcc) has a set of “real” sm_xx architectures that that it can assemble native (<code class="docutils literal notranslate"><span class="pre">CUDA</span></code> binary) code for.</p>
<p>This array contains a list of the sm architectures supported by the <span class="target" id="index-11"></span><a class="reference internal" href="#envvar-CUDA_VERSION"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_VERSION</span></code></a> version of <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> as an array of two digit numbers.</p>
<p class="rubric">Example</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">echo</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">CUDA_CODES</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="m">20</span> <span class="m">21</span> <span class="m">30</span> <span class="m">32</span> <span class="m">35</span> <span class="m">37</span> <span class="m">50</span> <span class="m">52</span> <span class="m">53</span> <span class="m">60</span> <span class="m">61</span> <span class="m">62</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><span class="target" id="index-12"></span><a class="reference internal" href="#envvar-CUDA_DEPRECATED"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_DEPRECATED</span></code></a></p>
</div>
<dl class="std envvar">
<dt id="envvar-CUDA_MINIMAL_DRIVER_VERSION">
<code class="sig-name descname">CUDA_MINIMAL_DRIVER_VERSION</code><a class="headerlink" href="#envvar-CUDA_MINIMAL_DRIVER_VERSION" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Required version of NVIDIA driver</p>
<p>Every version of <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> has a minimal version of the NVIDIA graphics-card driver that must be installed in order to support that version of <code class="docutils literal notranslate"><span class="pre">CUDA</span></code>. This is largely undocumented, despite being obviously important. This variable is set to the minimum required version of the NVIDIA driver for the <span class="target" id="index-13"></span><a class="reference internal" href="#envvar-CUDA_VERSION"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_VERSION</span></code></a> version of <code class="docutils literal notranslate"><span class="pre">CUDA</span></code>, as best as we’ve been able to determine.</p>
<dl class="std envvar">
<dt id="envvar-CUDA_DEPRECATED">
<code class="sig-name descname">CUDA_DEPRECATED</code><a class="headerlink" href="#envvar-CUDA_DEPRECATED" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>List of deprecated instruction sets supported by <code class="docutils literal notranslate"><span class="pre">CUDA</span></code></p>
<p>Some versions of <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> support old instruction sets, but print a deprecated warning. For those versions of <code class="docutils literal notranslate"><span class="pre">CUDA</span></code>, a <span class="target" id="index-14"></span><a class="reference internal" href="#envvar-CUDA_DEPRECATED"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_DEPRECATED</span></code></a> array is defined to list the two digit architectures that are supported yet deprecated in the <span class="target" id="index-15"></span><a class="reference internal" href="#envvar-CUDA_VERSION"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_VERSION</span></code></a> version of <code class="docutils literal notranslate"><span class="pre">CUDA</span></code>.</p>
<dl class="bash function">
<dt id="function-cuda_info.bsh cuda_capabilities">
<code class="sig-name descname">cuda_capabilities</code><a class="headerlink" href="#function-cuda_info.bsh cuda_capabilities" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Output</dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="index-16"></span><a class="reference internal" href="#envvar-CUDA_ARCHES"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_ARCHES</span></code></a> - Supported <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> virtual architectures (compute_xx)</p></li>
<li><p><span class="target" id="index-17"></span><a class="reference internal" href="#envvar-CUDA_CODES"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_CODES</span></code></a> - Supported <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> real architectures (sm_xx)</p></li>
<li><p><span class="target" id="index-18"></span><a class="reference internal" href="#envvar-CUDA_MINIMAL_DRIVER_VERSION"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_MINIMAL_DRIVER_VERSION</span></code></a> - Minimal NVIDIA driver version needed for <span class="target" id="index-19"></span><a class="reference internal" href="#envvar-CUDA_VERSION"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_VERSION</span></code></a> version of graphics-card driver</p></li>
<li><p>[<span class="target" id="index-20"></span><a class="reference internal" href="#envvar-CUDA_DEPRECATED"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_DEPRECATED</span></code></a>] - List of deprecated (yet working) architectures.</p></li>
</ul>
</dd>
</dl>
<p>Determine compiler capabilities for specific CDK</p>
<dl class="std envvar">
<dt id="envvar-CUDA_SUGGESTED_ARCHES">
<code class="sig-name descname">CUDA_SUGGESTED_ARCHES</code><a class="headerlink" href="#envvar-CUDA_SUGGESTED_ARCHES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Suggested “virtual” architectures to compile for</p>
<p>Instead of compiling for every architecture that the <span class="target" id="index-21"></span><a class="reference internal" href="#envvar-CUDA_VERSION"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_VERSION</span></code></a> version of <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> supports, <span class="target" id="index-22"></span><a class="reference internal" href="#envvar-CUDA_SUGGESTED_ARCHES"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_SUGGESTED_ARCHES</span></code></a> is the intersection between <span class="target" id="index-23"></span><a class="reference internal" href="#envvar-CUDA_CARD_ARCHES"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_CARD_ARCHES</span></code></a> and <span class="target" id="index-24"></span><a class="reference internal" href="#envvar-CUDA_ARCHES"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_ARCHES</span></code></a> so that you compile only for your cards.</p>
<dl class="std envvar">
<dt id="envvar-CUDA_SUGGESTED_CODES">
<code class="sig-name descname">CUDA_SUGGESTED_CODES</code><a class="headerlink" href="#envvar-CUDA_SUGGESTED_CODES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Suggested “real” architectures to compile for</p>
<p>Instead of compiling for every architecture that the <span class="target" id="index-25"></span><a class="reference internal" href="#envvar-CUDA_VERSION"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_VERSION</span></code></a> version of <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> supports, <span class="target" id="index-26"></span><a class="reference internal" href="#envvar-CUDA_SUGGESTED_CODES"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_SUGGESTED_CODES</span></code></a> is the intersection between <code class="docutils literal notranslate"><span class="pre">CUDA_CARD_CODES</span></code> and <span class="target" id="index-27"></span><a class="reference internal" href="#envvar-CUDA_CODES"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_CODES</span></code></a> so that you compile only for your cards.</p>
<dl class="std envvar">
<dt id="envvar-CUDA_SUGGESTED_PTX">
<code class="sig-name descname">CUDA_SUGGESTED_PTX</code><a class="headerlink" href="#envvar-CUDA_SUGGESTED_PTX" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Suggested PTX architectures to compile for</p>
<p>If your graphics card is too new for the <span class="target" id="index-28"></span><a class="reference internal" href="#envvar-CUDA_VERSION"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_VERSION</span></code></a> version of <code class="docutils literal notranslate"><span class="pre">CUDA</span></code>, you will need to compile to a pure virtual architecture (by embedding PTX code in the fatbinary) in order to use it. That way, the real architecture can be JIT (Just-In-Time) compiled for at runtime.</p>
<p><span class="target" id="index-29"></span><a class="reference internal" href="#envvar-CUDA_SUGGESTED_PTX"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_SUGGESTED_PTX</span></code></a> identifies the PTX architectures you need to run on newer (unsupported) cards. You can choose to add them to your builds.</p>
<dl class="std envvar">
<dt id="envvar-CUDA_FORWARD_PTX">
<code class="sig-name descname">CUDA_FORWARD_PTX</code><a class="headerlink" href="#envvar-CUDA_FORWARD_PTX" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>PTX arch for newer <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> cards</p>
<p>In situations where you are making portable fatbinaries, you should compile for every architecture. However, in order to future proof your fatbin for architectures newer than your current version of <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> supports, you will need to compile to a pure virtual architecture using the PTX feature so that the real architecture can be JIT (Just-In-Time) compiled.</p>
<p><span class="target" id="index-30"></span><a class="reference internal" href="#envvar-CUDA_FORWARD_PTX"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_FORWARD_PTX</span></code></a> identifies the fullest featured PTX architecture so that you can choose to add this to your builds.</p>
<dl class="bash function">
<dt id="function-cuda_info.bsh suggested_architectures">
<code class="sig-name descname">suggested_architectures</code><a class="headerlink" href="#function-cuda_info.bsh suggested_architectures" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Output</dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="index-31"></span><a class="reference internal" href="#envvar-CUDA_SUGGESTED_ARCHES"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_SUGGESTED_ARCHES</span></code></a> - Suggested virtual architectures for your cards</p></li>
<li><p><span class="target" id="index-32"></span><a class="reference internal" href="#envvar-CUDA_SUGGESTED_CODES"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_SUGGESTED_CODES</span></code></a> - Suggested real architectures for your cards</p></li>
<li><p><span class="target" id="index-33"></span><a class="reference internal" href="#envvar-CUDA_SUGGESTED_PTX"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_SUGGESTED_PTX</span></code></a> - Suggested PTX for your cards</p></li>
<li><p><span class="target" id="index-34"></span><a class="reference internal" href="#envvar-CUDA_FORWARD_PTX"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_FORWARD_PTX</span></code></a> - Potential forward compatibility PTX to compile for cards newer than your current <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> supports</p></li>
</ul>
</dd>
</dl>
<p>Calculate suggested architectures</p>
<dl class="bash function">
<dt id="function-cuda_info.bsh cmake_cuda_flags">
<code class="sig-name descname">cmake_cuda_flags</code><a class="headerlink" href="#function-cuda_info.bsh cmake_cuda_flags" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="index-35"></span><a class="reference internal" href="#envvar-CUDA_SUGGESTED_ARCHES"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_SUGGESTED_ARCHES</span></code></a> - List of virtual architectures to compile</p></li>
<li><p><span class="target" id="index-36"></span><a class="reference internal" href="#envvar-CUDA_SUGGESTED_CODES"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_SUGGESTED_CODES</span></code></a> - Matching list of real architectures to compile</p></li>
<li><p>[<span class="target" id="index-37"></span><a class="reference internal" href="#envvar-CUDA_SUGGESTED_PTX"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_SUGGESTED_PTX</span></code></a>] - Optional list of PTX architectures to compile</p></li>
</ul>
</dd>
<dt class="field-even">Output</dt>
<dd class="field-even"><p><em>stdout</em> - echoes out the value of the target_CUDA_architectures</p>
</dd>
</dl>
<p>Generate <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> flags for CMake</p>
<p>Modern CMake installs include a FindCUDA.cmake script which calls the select_compute_arch.cmake script (<a class="reference external" href="https://goo.gl/uZvAjR">https://goo.gl/uZvAjR</a>). It uses a limited version of the tables that <a class="reference internal" href="#file-cuda_info.bsh"><code class="xref bash bash-file docutils literal notranslate"><span class="pre">cuda_info.bsh</span></code></a> uses and is prone to being out of date.</p>
<p>This function will calculate the suggested value of target_CUDA_architectures for CMake’s:</p>
<blockquote>
<div><p>FindCUDA.cmake:select_compute_arch.cmake:CUDA_SELECT_NVCC_ARCH_FLAGS</p>
</div></blockquote>
<p>You will need to find where this is used and set the variable accordingly.</p>
<p class="rubric">Example</p>
<p>For example, PyTorch’s CMake contains:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>CUDA_SELECT_NVCC_ARCH_FLAGS<span class="o">(</span>NVCC_FLAGS_EXTRA <span class="nv">$ENV</span><span class="o">{</span>TORCH_CUDA_ARCH_LIST<span class="o">})</span>
</pre></div>
</div>
<p>Setting the environment variable <code class="docutils literal notranslate"><span class="pre">TORCH_CUDA_ARCH_LIST</span></code> to the output of <a class="reference internal" href="#function-cuda_info.bsh cmake_cuda_flags"><code class="xref bash bash-func docutils literal notranslate"><span class="pre">cmake_cuda_flags</span></code></a> will result in using the desired <code class="docutils literal notranslate"><span class="pre">CUDA</span></code> architecture and code versions.</p>
<p>To add the <span class="target" id="index-38"></span><a class="reference internal" href="#envvar-CUDA_FORWARD_PTX"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CUDA_FORWARD_PTX</span></code></a>, run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">CUDA_SUGGESTED_PTX</span><span class="o">+=(</span><span class="si">${</span><span class="nv">CUDA_FORWARD_PTX</span><span class="si">}</span><span class="o">)</span>
</pre></div>
</div>
<p>before calling <a class="reference internal" href="#function-cuda_info.bsh cmake_cuda_flags"><code class="xref bash bash-func docutils literal notranslate"><span class="pre">cmake_cuda_flags</span></code></a></p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="dir_tools.auto.html" class="btn btn-neutral float-right" title="Directory Tools" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="common_source.auto.html" class="btn btn-neutral float-left" title="Common Source" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Vision Systems, Inc

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>